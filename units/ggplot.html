<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Graphics with ggplot</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-2eb2de9d08919211f8a1d749abb3db00.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../assets/styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../units/intro.html">Modules</a></li><li class="breadcrumb-item"><a href="../units/ggplot.html">Plotting (ggplot)</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Voleon R Bootcamp</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/paciorek/r-voleon-2025" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home / Schedule</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preparation</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Modules</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Introduction (Module “0”)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Structures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/calculation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calculation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Wrangling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/ggplot.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Plotting (ggplot)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Analysis/Useful Packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/speed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Parallelization/Rcpp</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Breakout solutions</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#base-graphics" id="toc-base-graphics" class="nav-link" data-scroll-target="#base-graphics">Base graphics</a>
  <ul class="collapse">
  <li><a href="#other-plot-types-in-base-graphics" id="toc-other-plot-types-in-base-graphics" class="nav-link" data-scroll-target="#other-plot-types-in-base-graphics">Other plot types in base graphics</a></li>
  <li><a href="#object-oriented-plots" id="toc-object-oriented-plots" class="nav-link" data-scroll-target="#object-oriented-plots">Object-oriented plots</a></li>
  <li><a href="#proscons-of-base-graphics-vs.-ggplot" id="toc-proscons-of-base-graphics-vs.-ggplot" class="nav-link" data-scroll-target="#proscons-of-base-graphics-vs.-ggplot">Pros/cons of base graphics vs.&nbsp;ggplot</a></li>
  </ul></li>
  <li><a href="#ggplot" id="toc-ggplot" class="nav-link" data-scroll-target="#ggplot">ggplot</a>
  <ul class="collapse">
  <li><a href="#basic-usage-ggplot2" id="toc-basic-usage-ggplot2" class="nav-link" data-scroll-target="#basic-usage-ggplot2">Basic usage: <code>ggplot2</code></a></li>
  <li><a href="#grammar-of-graphics" id="toc-grammar-of-graphics" class="nav-link" data-scroll-target="#grammar-of-graphics">Grammar of graphics</a></li>
  <li><a href="#some-examples" id="toc-some-examples" class="nav-link" data-scroll-target="#some-examples">Some Examples</a></li>
  <li><a href="#ggplot-and-tidy-data" id="toc-ggplot-and-tidy-data" class="nav-link" data-scroll-target="#ggplot-and-tidy-data">ggplot and tidy data</a></li>
  <li><a href="#features-of-ggplot" id="toc-features-of-ggplot" class="nav-link" data-scroll-target="#features-of-ggplot">Features of ggplot</a></li>
  <li><a href="#an-overview-of-syntax-for-various-ggplot2-geoms" id="toc-an-overview-of-syntax-for-various-ggplot2-geoms" class="nav-link" data-scroll-target="#an-overview-of-syntax-for-various-ggplot2-geoms">An overview of syntax for various <code>ggplot2</code> geoms</a></li>
  <li><a href="#trellis-plots" id="toc-trellis-plots" class="nav-link" data-scroll-target="#trellis-plots">“Trellis” plots</a></li>
  <li><a href="#anatomy-of-aes" id="toc-anatomy-of-aes" class="nav-link" data-scroll-target="#anatomy-of-aes">Anatomy of <code>aes()</code></a></li>
  <li><a href="#using-aesthetics-to-highlight-features" id="toc-using-aesthetics-to-highlight-features" class="nav-link" data-scroll-target="#using-aesthetics-to-highlight-features">Using aesthetics to highlight features</a>
  <ul class="collapse">
  <li><a href="#differences-in-kind" id="toc-differences-in-kind" class="nav-link" data-scroll-target="#differences-in-kind">Differences in kind</a></li>
  <li><a href="#differences-in-degree" id="toc-differences-in-degree" class="nav-link" data-scroll-target="#differences-in-degree">Differences in degree</a></li>
  <li><a href="#multiple-non-coordinate-aesthetics-differences-in-kind-using-color-degree-using-point-size" id="toc-multiple-non-coordinate-aesthetics-differences-in-kind-using-color-degree-using-point-size" class="nav-link" data-scroll-target="#multiple-non-coordinate-aesthetics-differences-in-kind-using-color-degree-using-point-size">Multiple non-coordinate aesthetics (differences in kind using color, degree using point size)</a></li>
  </ul></li>
  <li><a href="#using-aesthetics-quick-quiz" id="toc-using-aesthetics-quick-quiz" class="nav-link" data-scroll-target="#using-aesthetics-quick-quiz">Using aesthetics: quick quiz</a></li>
  <li><a href="#where-do-i-put-aes-optional" id="toc-where-do-i-put-aes-optional" class="nav-link" data-scroll-target="#where-do-i-put-aes-optional">Where do I put <code>aes()</code>? (optional)</a></li>
  <li><a href="#scaling-aesthetics" id="toc-scaling-aesthetics" class="nav-link" data-scroll-target="#scaling-aesthetics">Scaling Aesthetics</a></li>
  <li><a href="#fine-tuning-your-plot" id="toc-fine-tuning-your-plot" class="nav-link" data-scroll-target="#fine-tuning-your-plot">Fine tuning your plot</a>
  <ul class="collapse">
  <li><a href="#labels" id="toc-labels" class="nav-link" data-scroll-target="#labels">Labels</a></li>
  <li><a href="#axis-and-point-scales" id="toc-axis-and-point-scales" class="nav-link" data-scroll-target="#axis-and-point-scales">Axis and point scales</a></li>
  <li><a href="#colors" id="toc-colors" class="nav-link" data-scroll-target="#colors">Colors</a></li>
  <li><a href="#point-styles-and-widths" id="toc-point-styles-and-widths" class="nav-link" data-scroll-target="#point-styles-and-widths">Point Styles and Widths</a></li>
  <li><a href="#line-styles-and-widths" id="toc-line-styles-and-widths" class="nav-link" data-scroll-target="#line-styles-and-widths">Line Styles and Widths</a></li>
  </ul></li>
  <li><a href="#themes-with-ggplot2-optional" id="toc-themes-with-ggplot2-optional" class="nav-link" data-scroll-target="#themes-with-ggplot2-optional">Themes with <code>ggplot2</code> (optional)</a></li>
  <li><a href="#combining-multiple-plots" id="toc-combining-multiple-plots" class="nav-link" data-scroll-target="#combining-multiple-plots">Combining Multiple Plots</a></li>
  <li><a href="#patchwork-combining-multiple-ggplot-plots-optional" id="toc-patchwork-combining-multiple-ggplot-plots-optional" class="nav-link" data-scroll-target="#patchwork-combining-multiple-ggplot-plots-optional"><code>patchwork</code>: Combining Multiple ggplot plots (optional)</a></li>
  </ul></li>
  <li><a href="#exporting" id="toc-exporting" class="nav-link" data-scroll-target="#exporting">Exporting</a>
  <ul class="collapse">
  <li><a href="#rasterbitmap-.png-.jpeg" id="toc-rasterbitmap-.png-.jpeg" class="nav-link" data-scroll-target="#rasterbitmap-.png-.jpeg"><strong>Raster/Bitmap</strong> (.png, .jpeg)</a></li>
  <li><a href="#vector-.pdf-.ps" id="toc-vector-.pdf-.ps" class="nav-link" data-scroll-target="#vector-.pdf-.ps"><strong>Vector</strong> (.pdf, .ps)</a></li>
  <li><a href="#exporting-with-ggplot" id="toc-exporting-with-ggplot" class="nav-link" data-scroll-target="#exporting-with-ggplot">Exporting with <code>ggplot</code></a></li>
  </ul></li>
  <li><a href="#breakout" id="toc-breakout" class="nav-link" data-scroll-target="#breakout">Breakout</a>
  <ul class="collapse">
  <li><a href="#basics" id="toc-basics" class="nav-link" data-scroll-target="#basics">Basics</a></li>
  <li><a href="#using-the-ideas" id="toc-using-the-ideas" class="nav-link" data-scroll-target="#using-the-ideas">Using the ideas</a></li>
  <li><a href="#advanced" id="toc-advanced" class="nav-link" data-scroll-target="#advanced">Advanced</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../units/intro.html">Modules</a></li><li class="breadcrumb-item"><a href="../units/ggplot.html">Plotting (ggplot)</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Graphics with ggplot</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="overview" class="level1">
<h1>Overview</h1>
<p>Most users use either base R graphics or ggplot (in the <code>ggplot2</code> package). We’ll focus on ggplot after a brief intro of base R graphics.</p>
<p>And here’s some motivation - we can produce a plot like <a href="gapminder.pdf">this</a> with a few lines of code.</p>
<p>(Compare to the <a href="https://s3-eu-west-1.amazonaws.com/static.gapminder.org/GapminderMedia/wp-uploads/20161019161829/screenshot2016.jpg">famous gapminder plot</a>.)</p>
<p>In 2018 or so, producing my version of the plot took me some time experimenting and Googling. I suspect one could do it with a ChatBot quite quickly now. But I’d be curious what errors there would be and how much debugging and knowledge of ggplot would be needed. See Problem 6 of the Breakout.</p>
</section>
<section id="base-graphics" class="level1">
<h1>Base graphics</h1>
<p>The general call for base plot looks something like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> , <span class="at">y =</span> , ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Additional parameters can be passed in to customize the plot:</p>
<ul>
<li><code>type</code>: scatterplot? lines? etc</li>
<li><code>main</code>: a title</li>
<li><code>xlab</code>, <code>ylab</code>: x-axis and y-axis labels</li>
<li><code>col</code>: color, either a string with the color name or a vector of color names for each point</li>
</ul>
<p>More layers can be added to the plot with additional calls to <code>lines</code>, <code>points</code>, <code>text</code>, etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>gapChina <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span> <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"China"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gapChina<span class="sc">$</span>year, gapChina<span class="sc">$</span>gdpPercap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gapChina<span class="sc">$</span>year, gapChina<span class="sc">$</span>gdpPercap, <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"China GDP over time"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Year"</span>, <span class="at">ylab =</span> <span class="st">"GDP per capita"</span>) <span class="co"># with updated parameters</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(gapChina<span class="sc">$</span>year, gapChina<span class="sc">$</span>gdpPercap, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> <span class="dv">1977</span>, <span class="at">y =</span> gapChina<span class="sc">$</span>gdpPercap[gapChina<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">1977</span>],</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="other-plot-types-in-base-graphics" class="level2">
<h2 class="anchored" data-anchor-id="other-plot-types-in-base-graphics">Other plot types in base graphics</h2>
<p>These are a variety of other types of plots you can make in base graphics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(lifeExp <span class="sc">~</span> year, <span class="at">data =</span> gapminder)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(gapminder<span class="sc">$</span>lifeExp[gapminder<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2007</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(gapminder<span class="sc">$</span>lifeExp[gapminder<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2007</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(gapChina<span class="sc">$</span>pop, <span class="at">width =</span> <span class="dv">4</span>, <span class="at">names.arg =</span> gapChina<span class="sc">$</span>year, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">main =</span> <span class="st">"China population"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-3-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="object-oriented-plots" class="level2">
<h2 class="anchored" data-anchor-id="object-oriented-plots">Object-oriented plots</h2>
<ul>
<li>Base graphics often recognizes the object type and will implement specific plot methods (see that <code>plot</code> is an S3 generic).</li>
<li>ggplot generally doesn’t exhibit this sort of behavior.</li>
</ul>
<p>Here are two examples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>gap_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> <span class="fu">log</span>(gdpPercap) <span class="sc">+</span> year, <span class="at">data =</span> gapminder)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calls plotting method for class of the dataset ("data.frame")</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gapminder[,<span class="fu">c</span>(<span class="st">'pop'</span>,<span class="st">'lifeExp'</span>,<span class="st">'gdpPercap'</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calls plotting method for class of gap_lm object ("lm"), print first two plots only</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gap_lm, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="proscons-of-base-graphics-vs.-ggplot" class="level2">
<h2 class="anchored" data-anchor-id="proscons-of-base-graphics-vs.-ggplot">Pros/cons of base graphics vs.&nbsp;ggplot</h2>
<p>Base graphics is:</p>
<ol type="a">
<li><p>good for exploratory data analysis and sanity checks</p></li>
<li><p>inconsistent in syntax across functions: some take x,y while others take formulas</p></li>
<li><p>default plotting parameters are ugly, and it can be difficult to customize</p></li>
<li><p>that said, one can do essentially anything in base graphics with some work</p></li>
</ol>
<p>ggplot2 is:</p>
<ol type="a">
<li><p>generally more elegant</p></li>
<li><p>more syntactically logical (and therefore simpler, once you learn it)</p></li>
<li><p>better at grouping</p></li>
<li><p>easy to interface with maps</p></li>
</ol>
<p>We’ll focus on <code>ggplot2</code> as it is very powerful, very widely-used and allows one to produce very nice-looking graphics without a lot of coding.</p>
</section>
</section>
<section id="ggplot" class="level1">
<h1>ggplot</h1>
<section id="basic-usage-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="basic-usage-ggplot2">Basic usage: <code>ggplot2</code></h2>
<p>The general call for <code>ggplot2</code> graphics looks something like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NOT run</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> , <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ,<span class="at">y =</span> , [options])) <span class="sc">+</span> <span class="fu">geom_xxxx</span>() <span class="sc">+</span> ... <span class="sc">+</span> ... <span class="sc">+</span> ...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that <code>ggplot2</code> graphs in layers in a <em>continuing call</em> (hence the endless +…+…+…), which makes additional layers in the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>... <span class="sc">+</span> <span class="fu">geom_xxxx</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> , <span class="at">y =</span> ,[options]), [options]) <span class="sc">+</span> ... <span class="sc">+</span> ... <span class="sc">+</span> ...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can see the layering effect by comparing the same graph with different colors for each layer</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> gapChina, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"life expectancy"</span>) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="grammar-of-graphics" class="level2">
<h2 class="anchored" data-anchor-id="grammar-of-graphics">Grammar of graphics</h2>
<p><code>ggplot2</code> syntax is very different from base R graphics. It’s built on the <strong>grammar of graphics</strong>. The basic idea is that the visualization of all data requires four items:</p>
<ol type="1">
<li><p>One or more <strong>statistics</strong> conveying information about the data (identities, means, medians, etc.)</p></li>
<li><p>A <strong>coordinate system</strong> that characterizes the intersections of statistics (at most two for ggplot, three for <code>lattice</code>)</p></li>
<li><p><strong>Geometries</strong> that differentiate between off-coordinate variation in <em>kind</em></p></li>
<li><p><strong>Scales</strong> that differentiate between off-coordinate variation in <em>degree</em></p></li>
</ol>
<p><code>ggplot2</code> allows the user to manipulate all four of these items through the <code>stat_*</code>, <code>coord_*</code>, <code>geom_*</code>, and <code>scale_*</code> functions.</p>
<p>All of these are important to becoming a ggplot expert, but today we are going to focus on the most important to basic users and their data layers: ggplot’s <em>geometries</em>.</p>
</section>
<section id="some-examples" class="level2">
<h2 class="anchored" data-anchor-id="some-examples">Some Examples</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Scatterplot</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapChina, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ggtitle</span>(<span class="st">"China's life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Line (time series) plot</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapChina, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ggtitle</span>(<span class="st">"China's life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Boxplot</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year), <span class="at">y =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ggtitle</span>(<span class="st">"World's life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Histogram</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>gapminder2007 <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder2007, <span class="fu">aes</span>(<span class="at">x =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ggtitle</span>(<span class="st">"World's life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ggplot-and-tidy-data" class="level2">
<h2 class="anchored" data-anchor-id="ggplot-and-tidy-data">ggplot and tidy data</h2>
<p><code>ggplot2</code> plays nicely with <code>dplyr</code> and pipes. If you want to manipulate your data specifically for one plot but not save the new dataset, you can call your <code>dplyr</code> chain and pipe it directly into a ggplot call.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This combines the subsetting and plotting into one step</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ggtitle</span>(<span class="st">"World's life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Base graphics and ggplot have a big difference: ggplot <strong>requires</strong> your data to be in <a href="tidyverse.html#tidying-data">tidy format</a>. For base graphics, it can actually be helpful <em>not</em> to have your data in tidy format in some cases.</p>
</section>
<section id="features-of-ggplot" class="level2">
<h2 class="anchored" data-anchor-id="features-of-ggplot">Features of ggplot</h2>
<ul>
<li>Allows you to add features in “layers”</li>
<li>Automatically adjusts spacing and sizing as you add more layers</li>
<li>Requires data to be in tidy format</li>
<li>Syntax is different from base R – there is a learning curve</li>
<li>Plots are actually objects. You can assign them to a variable and do things with it (more on this later)</li>
</ul>
</section>
<section id="an-overview-of-syntax-for-various-ggplot2-geoms" class="level2">
<h2 class="anchored" data-anchor-id="an-overview-of-syntax-for-various-ggplot2-geoms">An overview of syntax for various <code>ggplot2</code> geoms</h2>
<p>We’ve already seen these initial ones.</p>
<p>These are provided for reference – we won’t spend time on each one.</p>
<div class="callout callout-style-default callout-note callout-titled" title="X-Y scatter plots: `geom_point()`">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
X-Y scatter plots: <code>geom_point()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapChina, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ggtitle</span>(<span class="st">"China's life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="X-Y line plots: `geom_line()` or `geom_path()`">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
X-Y line plots: <code>geom_line()</code> or <code>geom_path()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapChina, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ggtitle</span>(<span class="st">"China's life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Histograms: `geom_histogram()`, `geom_col()`, or `geom_bar()`">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Histograms: <code>geom_histogram()</code>, <code>geom_col()</code>, or <code>geom_bar()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>gapminder2007 <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder2007, <span class="fu">aes</span>(<span class="at">x =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ggtitle</span>(<span class="st">"World's life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Densities: `geom_density()`, `geom_density2d()`">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Densities: <code>geom_density()</code>, <code>geom_density2d()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder2007, <span class="fu">aes</span>(<span class="at">x =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ggtitle</span>(<span class="st">"World's life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Boxplots: `geom_boxplot()`">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Boxplots: <code>geom_boxplot()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice that here, you must explicitly convert numeric years to factors</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year), <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_boxplot</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Contour plots: `geom_contour()`">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contour plots: <code>geom_contour()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(volcano) <span class="co"># Load volcano contour data</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>volcano[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] <span class="co"># Examine volcano dataset (first 10 rows and columns)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
 [1,]  100  100  101  101  101  101  101  100  100   100
 [2,]  101  101  102  102  102  102  102  101  101   101
 [3,]  102  102  103  103  103  103  103  102  102   102
 [4,]  103  103  104  104  104  104  104  103  103   103
 [5,]  104  104  105  105  105  105  105  104  104   103
 [6,]  105  105  105  106  106  106  106  105  105   104
 [7,]  105  106  106  107  107  107  107  106  106   105
 [8,]  106  107  107  108  108  108  108  107  107   106
 [9,]  107  108  108  109  109  109  109  108  108   107
[10,]  108  109  109  110  110  110  110  109  109   108</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>volcano3d <span class="ot">&lt;-</span> <span class="fu">melt</span>(volcano) <span class="co"># Use reshape2 package to melt the data into tidy form</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(volcano3d) <span class="co"># Examine volcano3d dataset (head)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Var1 Var2 value
1    1    1   100
2    2    1   101
3    3    1   102
4    4    1   103
5    5    1   104
6    6    1   105</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(volcano3d) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"xvar"</span>, <span class="st">"yvar"</span>, <span class="st">"zvar"</span>) <span class="co"># Rename volcano3d columns</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> volcano3d, <span class="fu">aes</span>(<span class="at">x =</span> xvar, <span class="at">y =</span> yvar, <span class="at">z =</span> zvar)) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_contour</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Tile/Image/Level plots, heatmaps: `geom_tile()`, `geom_rect()`, `geom_raster()`">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tile/Image/Level plots, heatmaps: <code>geom_tile()</code>, <code>geom_rect()</code>, <code>geom_raster()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> volcano3d, <span class="fu">aes</span>(<span class="at">x =</span> xvar, <span class="at">y =</span> yvar, <span class="at">z =</span> zvar)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> zvar)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="trellis-plots" class="level2">
<h2 class="anchored" data-anchor-id="trellis-plots">“Trellis” plots</h2>
<p>Trellis plots allow you to stratify by a variable, with one panel per categorical value. One uses either <code>facet_grid()</code> or <code>facet_wrap()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">facet_wrap</span>(<span class="sc">~</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This can be quite powerful. It gives you the ability to take account of an additional variable.</p>
</section>
<section id="anatomy-of-aes" class="level2">
<h2 class="anchored" data-anchor-id="anatomy-of-aes">Anatomy of <code>aes()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NOT run</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> , <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> , <span class="at">y =</span> , <span class="at">color =</span> , <span class="at">linetype =</span> , <span class="at">shape =</span> , <span class="at">size =</span> ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These four aesthetic parameters (<code>color</code>, <code>linetype</code>, <code>shape</code>, <code>size</code>) can be used to show variation in <em>kind</em> (categories) and variation in <em>degree</em> (numeric).</p>
<p>Parameters passed into <code>aes</code> should be <em>variables</em> in your dataset.</p>
<p>Parameters passed to <code>geom_xxx</code> outside of <code>aes</code> should <em>not</em> be related to your dataset – they apply to the whole figure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> country), <span class="at">show.legend =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note what happens when we specify the color parameter outside of the aesthetic operator. ggplot views these specifications as invalid graphical parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_line</span>(<span class="at">color =</span> country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'country' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"country"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `geom_line()`:
! Problem while converting geom to grob.
ℹ Error occurred in the 1st layer.
Caused by error:
! Unknown colour name: country</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## This 'works' syntactically but not substantively.</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Note:</strong> Aesthetics automatically show up in your legend. Parameters (those not mapped to a variable in your data frame) do not!</p>
</section>
<section id="using-aesthetics-to-highlight-features" class="level2">
<h2 class="anchored" data-anchor-id="using-aesthetics-to-highlight-features">Using aesthetics to highlight features</h2>
<section id="differences-in-kind" class="level3">
<h3 class="anchored" data-anchor-id="differences-in-kind">Differences in kind</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## color as the aesthetic to differentiate by continent</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder2007, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continent)) <span class="sc">+</span> <span class="fu">scale_x_log10</span>()</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="do">## point shape as the aesthetic to differentiate by continent</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder2007, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> continent)) <span class="sc">+</span> <span class="fu">scale_x_log10</span>()</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="do">## line type as the aesthetic to differentiate by country</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>gapOceania <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span> <span class="fu">filter</span>(continent <span class="sc">%in%</span> <span class="st">'Oceania'</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapOceania, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> country)) <span class="sc">+</span> <span class="fu">scale_x_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-22-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="differences-in-degree" class="level3">
<h3 class="anchored" data-anchor-id="differences-in-degree">Differences in degree</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">## point size as the aesthetic to differentiate by population</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder2007, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> pop)) <span class="sc">+</span> <span class="fu">scale_x_log10</span>()</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="do">## color as the aesthetic to differentiate by population</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder2007, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> pop)) <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">'lightgray'</span>, <span class="at">high =</span> <span class="st">'black'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="multiple-non-coordinate-aesthetics-differences-in-kind-using-color-degree-using-point-size" class="level3">
<h3 class="anchored" data-anchor-id="multiple-non-coordinate-aesthetics-differences-in-kind-using-color-degree-using-point-size">Multiple non-coordinate aesthetics (differences in kind using color, degree using point size)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder2007, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> pop, <span class="at">color =</span> continent)) <span class="sc">+</span> <span class="fu">scale_x_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Question">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question
</div>
</div>
<div class="callout-body-container callout-body">
<p>How many variables have we represented? If we used a trellis plot we could represent yet another variable!</p>
</div>
</div>
</section>
</section>
<section id="using-aesthetics-quick-quiz" class="level2">
<h2 class="anchored" data-anchor-id="using-aesthetics-quick-quiz">Using aesthetics: quick quiz</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Question">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question
</div>
</div>
<div class="callout-body-container callout-body">
<p>Which of these ggplot2 calls will work (in the sense of not giving an error, not in the sense of being a useful plot)?</p>
<ol type="1">
<li><code>gapminder |&gt; ggplot(aes(x = gdpPercap, y = lifeExp)) |&gt; geom_point()</code></li>
<li><code>gapminder |&gt; ggplot(aes(x = gdpPercap, y = lifeExp))</code></li>
<li><code>gapminder |&gt; ggplot(aes(x = gdpPercap, y = lifeExp)) + geom_point()</code></li>
<li><code>gapminder |&gt; ggplot(aes(x = gdpPercap, y = lifeExp, shape = 'a')) + geom_point()</code></li>
<li><code>gapminder |&gt; ggplot(aes(x = gdpPercap, y = lifeExp)) + geom_point(aes(shape = country), show.legend = FALSE)</code></li>
<li><code>gapminder |&gt; ggplot(aes(x = gdpPercap, y = lifeExp)) + geom_point(shape = 'a', show.legend = FALSE)</code></li>
<li><code>gapminder |&gt; ggplot() + geom_point(aes(x = gdpPercap, y = lifeExp, shape = country), show.legend = FALSE)</code></li>
</ol>
</div>
</div>
</section>
<section id="where-do-i-put-aes-optional" class="level2">
<h2 class="anchored" data-anchor-id="where-do-i-put-aes-optional">Where do I put <code>aes()</code>? (optional)</h2>
<p>As seen in the code snippets in the quick quiz, one can put <code>aes()</code> in the original <code>ggplot()</code> call or in latter <code>geom_x()</code> calls. What’s the difference?</p>
<ul>
<li>If one puts <code>aes()</code> in <code>ggplot()</code>, it affects all subsequent calls that are part of the same ggplot expression.</li>
<li>If one puts <code>aes()</code> in a <code>geom_x()</code>, it affects only that particular component of the plotting.</li>
</ul>
<p>So where you put it affects the “scope” of what it affects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">"Oceania"</span>) <span class="sc">|&gt;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> gdpPercap, <span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">"Oceania"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> gdpPercap)) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> country)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Yikes, this doesn't work right:</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">"Oceania"</span>) <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> gdpPercap)) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> country)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-25-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scaling-aesthetics" class="level2">
<h2 class="anchored" data-anchor-id="scaling-aesthetics">Scaling Aesthetics</h2>
<p>Aesthetics are handled by their very own <code>scale</code> functions which allow you to set the limits, breaks, transformations, and any palletes that might determine how you want your data plotted. ggplot includes a number of helpful default scale functions. For example:</p>
<ul>
<li><code>scale_x_log10</code> that can transform your data on the fly</li>
<li><code>scale_color_viridis</code> uses palettes from the <code>viridis</code> package specifically designed to “make plots that are pretty, better represent your data, easier to read by those with colorblindness, and print well in grey scale.”</li>
</ul>
<p>For example, our data might be better represented using a log10 transformation of per capita GDP:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>And perhaps we want colors that are a little different:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Or perhaps we want to set your palettes and breaks or labels manually:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"The continents"</span>, </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"yellow"</span>, <span class="st">"#800080"</span>)) <span class="co"># hex codes work!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For more info about setting scales in ggplot and for more helper functions consider diving into the <code>scales</code> package which is the backend to much of the scales functionality in ggplot</p>
</section>
<section id="fine-tuning-your-plot" class="level2">
<h2 class="anchored" data-anchor-id="fine-tuning-your-plot">Fine tuning your plot</h2>
<p><code>ggplot</code> handles many plot options as additional layers.</p>
<section id="labels" class="level3">
<h3 class="anchored" data-anchor-id="labels">Labels</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder2007, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="at">label =</span> <span class="st">"GDP per capita"</span>) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="at">label =</span> <span class="st">"Life expectancy"</span>) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">"Gapminder"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Or even more simply use the <code>labs()</code> function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder2007, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"GDP per capita"</span>, <span class="at">y =</span> <span class="st">"Life expectancy"</span>, <span class="at">title =</span> <span class="st">"Gapminder"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="axis-and-point-scales" class="level3">
<h3 class="anchored" data-anchor-id="axis-and-point-scales">Axis and point scales</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>() </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-31-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="colors" class="level3">
<h3 class="anchored" data-anchor-id="colors">Colors</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">colors</span>()[<span class="dv">11</span>]) </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="point-styles-and-widths" class="level3">
<h3 class="anchored" data-anchor-id="point-styles-and-widths">Point Styles and Widths</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">3</span>) </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="st">"w"</span>) </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="st">"$"</span>, <span class="at">size=</span><span class="dv">5</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-33-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="line-styles-and-widths" class="level3">
<h3 class="anchored" data-anchor-id="line-styles-and-widths">Line Styles and Widths</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapChina, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="dv">1</span>) </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapChina, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="dv">2</span>) </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapChina, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="dv">5</span>, <span class="at">size =</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-34-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="themes-with-ggplot2-optional" class="level2">
<h2 class="anchored" data-anchor-id="themes-with-ggplot2-optional">Themes with <code>ggplot2</code> (optional)</h2>
<p>Elements of the plot <em>not associated with geometries</em> can be adjusted using ggplot <em>themes</em>.</p>
<p>There are some “complete” themes already included with the package:</p>
<ul>
<li><code>theme_gray()</code> (the default)</li>
<li><code>theme_minimal()</code></li>
<li><code>theme_bw()</code></li>
<li><code>theme_light()</code></li>
<li><code>theme_dark()</code></li>
<li><code>theme_classic()</code></li>
</ul>
<p>But in additional to these, you can tweak just about any element of your plot’s appearance using the <code>theme()</code> function.</p>
<p>For instance, perhaps you want to move the legend from the left to the bottom of your plot, this would be part of the plot theme. Note how you can add options to a complete theme already in the plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"China"</span>, <span class="st">"Turkey"</span>, <span class="st">"Italy"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="combining-multiple-plots" class="level2">
<h2 class="anchored" data-anchor-id="combining-multiple-plots">Combining Multiple Plots</h2>
<p>ggplot graphs can be combined using the <code>grid.arrange()</code> function in the <code>gridExtra</code> package. This takes advantage of each plot being an object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 3 plots to combine in a table</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> gapminder2007, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">'text'</span>, <span class="dv">150</span>, <span class="dv">80</span>, <span class="at">label =</span> <span class="st">'(a)'</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> gapminder2007, <span class="fu">aes</span>(<span class="at">x =</span> pop, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">'text'</span>, <span class="fl">1.8e5</span>, <span class="dv">80</span>, <span class="at">label =</span> <span class="st">'(b)'</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> country), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">annotate</span>(<span class="st">'text'</span>, <span class="dv">1951</span>, <span class="dv">80</span>, <span class="at">label =</span> <span class="st">'(c)'</span>)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Call grid.arrange</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1, plot2, plot3, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="patchwork-combining-multiple-ggplot-plots-optional" class="level2">
<h2 class="anchored" data-anchor-id="patchwork-combining-multiple-ggplot-plots-optional"><code>patchwork</code>: Combining Multiple ggplot plots (optional)</h2>
<ul>
<li>The <code>patchwork</code> package may be used to combine multiple ggplot plots using a small set of operators similar to the pipe.</li>
<li>This requires less syntax than using <code>gridExtra</code> and allows complex arrangements to be built nearly effortlessly.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># use the patchwork operators</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># stack plots horizontally</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>plot1 <span class="sc">+</span> plot2 <span class="sc">+</span> plot3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stack plots vertically</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>plot1 <span class="sc">/</span> plot2 <span class="sc">/</span> plot3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># side-by-side plots with third plot below</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>(plot1 <span class="sc">|</span> plot2) <span class="sc">/</span> plot3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># side-by-side plots with a space in between, and a third plot below</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>(plot1 <span class="sc">|</span> <span class="fu">plot_spacer</span>() <span class="sc">|</span> plot2) <span class="sc">/</span> plot3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stack plots vertically and alter with a single "gg_theme"</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>(plot1 <span class="sc">/</span> plot2 <span class="sc">/</span> plot3) <span class="sc">&amp;</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="ggplot extensions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
ggplot extensions
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>patchwork</code> is an example of a ggplot2 extension package of which there are many! One of the benefits to learning and using ggplot is that there is a huge community of developers that build separate graphics packages that generally use the same syntax to extend the <code>ggplot2</code> functionality into things like animation and 3D plotting! <a href="http://www.ggplot2-exts.org/gallery/">Check them out here</a>.</p>
</div>
</div>
</section>
</section>
<section id="exporting" class="level1">
<h1>Exporting</h1>
<p>There are two basic image formats: raster and vector.</p>
<section id="rasterbitmap-.png-.jpeg" class="level2">
<h2 class="anchored" data-anchor-id="rasterbitmap-.png-.jpeg"><strong>Raster/Bitmap</strong> (.png, .jpeg)</h2>
<p>Every pixel of a plot contains its own separate coding:</p>
<ul>
<li>sensible for gridded/raster output</li>
<li><strong>bad if you want to resize the image</strong></li>
<li>file size depends on pixel resolution</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="at">filename =</span> <span class="st">"example.jpg"</span>, <span class="at">width =</span> , <span class="at">height =</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="vector-.pdf-.ps" class="level2">
<h2 class="anchored" data-anchor-id="vector-.pdf-.ps"><strong>Vector</strong> (.pdf, .ps)</h2>
<p>Every element of a plot is encoded as a representation of its shape</p>
<ul>
<li><strong>great for resizing</strong></li>
<li>image files with many elements can be very large.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">"example.pdf"</span>, <span class="at">width =</span> , <span class="at">height =</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exporting-with-ggplot" class="level2">
<h2 class="anchored" data-anchor-id="exporting-with-ggplot">Exporting with <code>ggplot</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume we saved our plot as an object called `plot1`.</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"example.pdf"</span>, <span class="at">plot =</span> plot1, <span class="at">scale =</span> , <span class="at">width =</span> , <span class="at">height =</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="breakout" class="level1">
<h1>Breakout</h1>
<p>These questions ask you to work with the gapminder dataset.</p>
<section id="basics" class="level2">
<h2 class="anchored" data-anchor-id="basics">Basics</h2>
<ol type="1">
<li><p>Plot a histogram of life expectancy.</p></li>
<li><p>Plot the gdp per capita against population. Put the x-axis on the log scale.</p></li>
<li><p>Clean up your scatterplot with a title and axis labels. Output it as a PDF and see if you’d be comfortable with including it in a report/paper.</p></li>
</ol>
</section>
<section id="using-the-ideas" class="level2">
<h2 class="anchored" data-anchor-id="using-the-ideas">Using the ideas</h2>
<ol start="4" type="1">
<li><p>Create a trellis plot of life expectancy by gdpPercap scatterplots, one subplot per continent. Use a 2x3 layout of panels in the plot. Now have the size of the points vary with population. Use <code>coord_cartesian()</code> (or <code>scale_x_continuous(</code>) to set the x-axis limits to be in the range from 100 to 50000.</p></li>
<li><p>Make a boxplot of life expectancy conditional on binned values of gdp per capita.</p></li>
</ol>
</section>
<section id="advanced" class="level2">
<h2 class="anchored" data-anchor-id="advanced">Advanced</h2>
<ol start="6" type="1">
<li><p>Try to create a facsimile of the <a href="https://s3-eu-west-1.amazonaws.com/static.gapminder.org/GapminderMedia/wp-uploads/20161019161829/screenshot2016.jpg">famous Gapminder plot</a> without looking at my code by using a ChatBot, providing it with information about the gapminder dataframe. For simplicity just try to create a static image (ignoring the ‘play’ button at bottom) for a single year such as 2007.</p></li>
<li><p>Alternatively (to #6), using the data for 2007, but <em>without</em> using a ChatBot, recreate as much as you can of the <a href="https://s3-eu-west-1.amazonaws.com/static.gapminder.org/GapminderMedia/wp-uploads/20161019161829/screenshot2016.jpg">famous Gapminder plot</a>. For simplicity just try to create a static image (ignoring the ‘play’ button at bottom) for a single year such as 2007.</p></li>
</ol>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/paciorek\.github\.io\/r-voleon-2025");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb63" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Graphics with ggplot"</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co">    css: ../assets/styles.css</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-bg: true</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-border-left: "#31BAE9"</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="co">  freeze: auto</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, chunksetup}</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="in">#| include: false</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a><span class="in"># include any code here you don't want to show up in the document,</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="in"># e.g. package and dataset loading</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a><span class="in">rm(list=ls())</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a><span class="in">library(gapminder)</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyr)</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="in">library(gridExtra)</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a><span class="in">library(reshape2)</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a><span class="in">library(patchwork)</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a><span class="fu"># Overview</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>Most users use either base R graphics or ggplot (in the <span class="in">`ggplot2`</span> package). We'll focus on ggplot after a brief intro of base R graphics.</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>And here's some motivation - we can produce a plot like <span class="co">[</span><span class="ot">this</span><span class="co">](gapminder.pdf)</span> with a few lines of code.</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>(Compare to the <span class="co">[</span><span class="ot">famous gapminder plot</span><span class="co">](https://s3-eu-west-1.amazonaws.com/static.gapminder.org/GapminderMedia/wp-uploads/20161019161829/screenshot2016.jpg)</span>.)</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>In 2018 or so, producing my version of the plot took me some time experimenting and Googling. I suspect one could do it with a ChatBot quite quickly now. But I'd be curious what errors there would be and how much debugging and knowledge of ggplot would be needed. See Problem 6 of the Breakout.</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a><span class="fu"># Base graphics</span></span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>The general call for base plot looks something like this:</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a><span class="in">plot(x = , y = , ...)</span></span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>Additional parameters can be passed in to customize the plot:</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`type`</span>: scatterplot? lines? etc</span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`main`</span>: a title</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`xlab`</span>, <span class="in">`ylab`</span>: x-axis and y-axis labels</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`col`</span>: color, either a string with the color name or a vector of color names for each point</span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>More layers can be added to the plot with additional calls to <span class="in">`lines`</span>, <span class="in">`points`</span>, <span class="in">`text`</span>, etc.</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap = ""}</span></span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a><span class="in">gapChina &lt;- gapminder %&gt;% filter(country == "China")</span></span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a><span class="in">plot(gapChina$year, gapChina$gdpPercap)</span></span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a><span class="in">plot(gapChina$year, gapChina$gdpPercap, type = "l",</span></span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a><span class="in">     main = "China GDP over time",</span></span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a><span class="in">     xlab = "Year", ylab = "GDP per capita") # with updated parameters</span></span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a><span class="in">points(gapChina$year, gapChina$gdpPercap, pch = 16)</span></span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a><span class="in">points(x = 1977, y = gapChina$gdpPercap[gapChina$year == 1977],</span></span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a><span class="in">       col = "red", pch = 16)</span></span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a><span class="fu">## Other plot types in base graphics</span></span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>These are a variety of other types of plots you can make in base graphics.</span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap = ""}</span></span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a><span class="in">boxplot(lifeExp ~ year, data = gapminder)</span></span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a><span class="in">hist(gapminder$lifeExp[gapminder$year == 2007])</span></span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a><span class="in">plot(density(gapminder$lifeExp[gapminder$year == 2007]))</span></span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a><span class="in">barplot(gapChina$pop, width = 4, names.arg = gapChina$year, </span></span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a><span class="in">                               main = "China population")</span></span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a><span class="fu">## Object-oriented plots</span></span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Base graphics often recognizes the object type and will implement specific plot methods (see that <span class="in">`plot`</span> is an S3 generic).</span>
<span id="cb63-83"><a href="#cb63-83" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>ggplot generally doesn't exhibit this sort of behavior.</span>
<span id="cb63-84"><a href="#cb63-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-85"><a href="#cb63-85" aria-hidden="true" tabindex="-1"></a>Here are two examples:</span>
<span id="cb63-86"><a href="#cb63-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-87"><a href="#cb63-87" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" "}</span></span>
<span id="cb63-88"><a href="#cb63-88" aria-hidden="true" tabindex="-1"></a><span class="in">gap_lm &lt;- lm(lifeExp ~ log(gdpPercap) + year, data = gapminder)</span></span>
<span id="cb63-89"><a href="#cb63-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-90"><a href="#cb63-90" aria-hidden="true" tabindex="-1"></a><span class="in"># Calls plotting method for class of the dataset ("data.frame")</span></span>
<span id="cb63-91"><a href="#cb63-91" aria-hidden="true" tabindex="-1"></a><span class="in">plot(gapminder[,c('pop','lifeExp','gdpPercap')])</span></span>
<span id="cb63-92"><a href="#cb63-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-93"><a href="#cb63-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-94"><a href="#cb63-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=""}</span></span>
<span id="cb63-95"><a href="#cb63-95" aria-hidden="true" tabindex="-1"></a><span class="in"># Calls plotting method for class of gap_lm object ("lm"), print first two plots only</span></span>
<span id="cb63-96"><a href="#cb63-96" aria-hidden="true" tabindex="-1"></a><span class="in">plot(gap_lm, which=1:2)</span></span>
<span id="cb63-97"><a href="#cb63-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-98"><a href="#cb63-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-99"><a href="#cb63-99" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pros/cons of base graphics vs. ggplot</span></span>
<span id="cb63-100"><a href="#cb63-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-101"><a href="#cb63-101" aria-hidden="true" tabindex="-1"></a>Base graphics is:</span>
<span id="cb63-102"><a href="#cb63-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-103"><a href="#cb63-103" aria-hidden="true" tabindex="-1"></a>a) good for exploratory data analysis and sanity checks</span>
<span id="cb63-104"><a href="#cb63-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-105"><a href="#cb63-105" aria-hidden="true" tabindex="-1"></a>b) inconsistent in syntax across functions: some take x,y while others take formulas</span>
<span id="cb63-106"><a href="#cb63-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-107"><a href="#cb63-107" aria-hidden="true" tabindex="-1"></a>c) default plotting parameters are ugly, and it can be difficult to customize</span>
<span id="cb63-108"><a href="#cb63-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-109"><a href="#cb63-109" aria-hidden="true" tabindex="-1"></a>d) that said, one can do essentially anything in base graphics with some work</span>
<span id="cb63-110"><a href="#cb63-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-111"><a href="#cb63-111" aria-hidden="true" tabindex="-1"></a>ggplot2 is:</span>
<span id="cb63-112"><a href="#cb63-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-113"><a href="#cb63-113" aria-hidden="true" tabindex="-1"></a>a) generally more elegant</span>
<span id="cb63-114"><a href="#cb63-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-115"><a href="#cb63-115" aria-hidden="true" tabindex="-1"></a>b) more syntactically logical (and therefore simpler, once you learn it)</span>
<span id="cb63-116"><a href="#cb63-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-117"><a href="#cb63-117" aria-hidden="true" tabindex="-1"></a>c) better at grouping</span>
<span id="cb63-118"><a href="#cb63-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-119"><a href="#cb63-119" aria-hidden="true" tabindex="-1"></a>d) easy to interface with maps</span>
<span id="cb63-120"><a href="#cb63-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-121"><a href="#cb63-121" aria-hidden="true" tabindex="-1"></a>We'll focus on <span class="in">`ggplot2`</span> as it is very powerful, very widely-used and allows one to produce very nice-looking graphics without a lot of coding.</span>
<span id="cb63-122"><a href="#cb63-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-123"><a href="#cb63-123" aria-hidden="true" tabindex="-1"></a><span class="fu"># ggplot</span></span>
<span id="cb63-124"><a href="#cb63-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-125"><a href="#cb63-125" aria-hidden="true" tabindex="-1"></a><span class="fu">## Basic usage: `ggplot2`</span></span>
<span id="cb63-126"><a href="#cb63-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-127"><a href="#cb63-127" aria-hidden="true" tabindex="-1"></a>The general call for <span class="in">`ggplot2`</span> graphics looks something like this:</span>
<span id="cb63-128"><a href="#cb63-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-129"><a href="#cb63-129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb63-130"><a href="#cb63-130" aria-hidden="true" tabindex="-1"></a><span class="in"># NOT run</span></span>
<span id="cb63-131"><a href="#cb63-131" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = , mapping = aes(x = ,y = , [options])) + geom_xxxx() + ... + ... + ...</span></span>
<span id="cb63-132"><a href="#cb63-132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-133"><a href="#cb63-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-134"><a href="#cb63-134" aria-hidden="true" tabindex="-1"></a>Note that <span class="in">`ggplot2`</span> graphs in layers in a *continuing call* (hence the endless +...+...+...), which makes additional layers in the plot.</span>
<span id="cb63-135"><a href="#cb63-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-136"><a href="#cb63-136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb63-137"><a href="#cb63-137" aria-hidden="true" tabindex="-1"></a><span class="in">... + geom_xxxx(mapping = aes(x = , y = ,[options]), [options]) + ... + ... + ...</span></span>
<span id="cb63-138"><a href="#cb63-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-139"><a href="#cb63-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-140"><a href="#cb63-140" aria-hidden="true" tabindex="-1"></a>You can see the layering effect by comparing the same graph with different colors for each layer</span>
<span id="cb63-141"><a href="#cb63-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-142"><a href="#cb63-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE}</span></span>
<span id="cb63-143"><a href="#cb63-143" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- ggplot(data = gapChina, aes(x = year, y = lifeExp)) +</span></span>
<span id="cb63-144"><a href="#cb63-144" aria-hidden="true" tabindex="-1"></a><span class="in">                 geom_point(color = "red")</span></span>
<span id="cb63-145"><a href="#cb63-145" aria-hidden="true" tabindex="-1"></a><span class="in">p</span></span>
<span id="cb63-146"><a href="#cb63-146" aria-hidden="true" tabindex="-1"></a><span class="in">p + geom_point(aes(x = year, y = lifeExp), color = "gray") + ylab("life expectancy") +</span></span>
<span id="cb63-147"><a href="#cb63-147" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_minimal()</span></span>
<span id="cb63-148"><a href="#cb63-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-149"><a href="#cb63-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-150"><a href="#cb63-150" aria-hidden="true" tabindex="-1"></a><span class="fu">## Grammar of graphics</span></span>
<span id="cb63-151"><a href="#cb63-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-152"><a href="#cb63-152" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot2`</span> syntax is very different from base R graphics. It's built on the **grammar of graphics**.</span>
<span id="cb63-153"><a href="#cb63-153" aria-hidden="true" tabindex="-1"></a>The basic idea is that the visualization of all data requires four items:</span>
<span id="cb63-154"><a href="#cb63-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-155"><a href="#cb63-155" aria-hidden="true" tabindex="-1"></a>1) One or more **statistics** conveying information about the data (identities, means, medians, etc.)</span>
<span id="cb63-156"><a href="#cb63-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-157"><a href="#cb63-157" aria-hidden="true" tabindex="-1"></a>2) A **coordinate system** that characterizes the intersections of statistics (at most two for ggplot, three for <span class="in">`lattice`</span>)</span>
<span id="cb63-158"><a href="#cb63-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-159"><a href="#cb63-159" aria-hidden="true" tabindex="-1"></a>3) **Geometries** that differentiate between off-coordinate variation in *kind*</span>
<span id="cb63-160"><a href="#cb63-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-161"><a href="#cb63-161" aria-hidden="true" tabindex="-1"></a>4) **Scales** that differentiate between off-coordinate variation in *degree*</span>
<span id="cb63-162"><a href="#cb63-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-163"><a href="#cb63-163" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot2`</span> allows the user to manipulate all four of these items through the</span>
<span id="cb63-164"><a href="#cb63-164" aria-hidden="true" tabindex="-1"></a><span class="in">`stat_*`</span>, <span class="in">`coord_*`</span>, <span class="in">`geom_*`</span>, and <span class="in">`scale_*`</span> functions.</span>
<span id="cb63-165"><a href="#cb63-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-166"><a href="#cb63-166" aria-hidden="true" tabindex="-1"></a>All of these are important to becoming a ggplot expert, but today we are going to focus on the most important to basic users and their data layers: ggplot's *geometries*.</span>
<span id="cb63-167"><a href="#cb63-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-168"><a href="#cb63-168" aria-hidden="true" tabindex="-1"></a><span class="fu">## Some Examples</span></span>
<span id="cb63-169"><a href="#cb63-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-170"><a href="#cb63-170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, message = FALSE, fig.cap = ""}</span></span>
<span id="cb63-171"><a href="#cb63-171" aria-hidden="true" tabindex="-1"></a><span class="in">## Scatterplot</span></span>
<span id="cb63-172"><a href="#cb63-172" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(gapChina, aes(x = year, y = lifeExp)) + geom_point() +</span></span>
<span id="cb63-173"><a href="#cb63-173" aria-hidden="true" tabindex="-1"></a><span class="in">                          ggtitle("China's life expectancy")</span></span>
<span id="cb63-174"><a href="#cb63-174" aria-hidden="true" tabindex="-1"></a><span class="in">## Line (time series) plot</span></span>
<span id="cb63-175"><a href="#cb63-175" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(gapChina, aes(x = year, y = lifeExp)) + geom_line() +</span></span>
<span id="cb63-176"><a href="#cb63-176" aria-hidden="true" tabindex="-1"></a><span class="in">                          ggtitle("China's life expectancy")</span></span>
<span id="cb63-177"><a href="#cb63-177" aria-hidden="true" tabindex="-1"></a><span class="in">## Boxplot</span></span>
<span id="cb63-178"><a href="#cb63-178" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(gapminder, aes(x = factor(year), y = lifeExp)) + geom_boxplot() +</span></span>
<span id="cb63-179"><a href="#cb63-179" aria-hidden="true" tabindex="-1"></a><span class="in">                          ggtitle("World's life expectancy")</span></span>
<span id="cb63-180"><a href="#cb63-180" aria-hidden="true" tabindex="-1"></a><span class="in">## Histogram</span></span>
<span id="cb63-181"><a href="#cb63-181" aria-hidden="true" tabindex="-1"></a><span class="in">gapminder2007 &lt;- gapminder |&gt; filter(year == 2007)</span></span>
<span id="cb63-182"><a href="#cb63-182" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(gapminder2007, aes(x = lifeExp)) + geom_histogram(binwidth = 5) +</span></span>
<span id="cb63-183"><a href="#cb63-183" aria-hidden="true" tabindex="-1"></a><span class="in">                          ggtitle("World's life expectancy")</span></span>
<span id="cb63-184"><a href="#cb63-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-185"><a href="#cb63-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-186"><a href="#cb63-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-187"><a href="#cb63-187" aria-hidden="true" tabindex="-1"></a><span class="fu">## ggplot and tidy data</span></span>
<span id="cb63-188"><a href="#cb63-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-189"><a href="#cb63-189" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot2`</span> plays nicely with <span class="in">`dplyr`</span> and pipes. If you want to manipulate your data specifically for one plot but not save the new dataset, you can call your <span class="in">`dplyr`</span> chain and pipe it directly into a ggplot call.</span>
<span id="cb63-190"><a href="#cb63-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-191"><a href="#cb63-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap = "", fig.show = "hold"}</span></span>
<span id="cb63-192"><a href="#cb63-192" aria-hidden="true" tabindex="-1"></a><span class="in"># This combines the subsetting and plotting into one step</span></span>
<span id="cb63-193"><a href="#cb63-193" aria-hidden="true" tabindex="-1"></a><span class="in">gapminder |&gt; filter(year == 2007) |&gt; </span></span>
<span id="cb63-194"><a href="#cb63-194" aria-hidden="true" tabindex="-1"></a><span class="in">        ggplot(aes(x = lifeExp)) + geom_histogram(binwidth = 5) +</span></span>
<span id="cb63-195"><a href="#cb63-195" aria-hidden="true" tabindex="-1"></a><span class="in">                          ggtitle("World's life expectancy")</span></span>
<span id="cb63-196"><a href="#cb63-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-197"><a href="#cb63-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-198"><a href="#cb63-198" aria-hidden="true" tabindex="-1"></a>Base graphics and ggplot have a big difference: ggplot **requires** your data to be in <span class="co">[</span><span class="ot">tidy format</span><span class="co">](tidyverse.html#tidying-data)</span>. For base graphics, it can actually be helpful *not* to have your data in tidy format in some cases.</span>
<span id="cb63-199"><a href="#cb63-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-200"><a href="#cb63-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-201"><a href="#cb63-201" aria-hidden="true" tabindex="-1"></a><span class="fu">## Features of ggplot</span></span>
<span id="cb63-202"><a href="#cb63-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-203"><a href="#cb63-203" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Allows you to add features in "layers"</span>
<span id="cb63-204"><a href="#cb63-204" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Automatically adjusts spacing and sizing as you add more layers</span>
<span id="cb63-205"><a href="#cb63-205" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Requires data to be in tidy format</span>
<span id="cb63-206"><a href="#cb63-206" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Syntax is different from base R -- there is a learning curve</span>
<span id="cb63-207"><a href="#cb63-207" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Plots are actually objects. You can assign them to a variable and do things with it (more on this later)</span>
<span id="cb63-208"><a href="#cb63-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-209"><a href="#cb63-209" aria-hidden="true" tabindex="-1"></a><span class="fu">## An overview of syntax for various `ggplot2` geoms</span></span>
<span id="cb63-210"><a href="#cb63-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-211"><a href="#cb63-211" aria-hidden="true" tabindex="-1"></a>We've already seen these initial ones.</span>
<span id="cb63-212"><a href="#cb63-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-213"><a href="#cb63-213" aria-hidden="true" tabindex="-1"></a>These are provided for reference -- we won't spend time on each one.</span>
<span id="cb63-214"><a href="#cb63-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-215"><a href="#cb63-215" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="X-Y scatter plots: <span class="in">`geom_point()`</span>" collapse="true"}</span>
<span id="cb63-216"><a href="#cb63-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-217"><a href="#cb63-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE, fig.show = "hold"}</span></span>
<span id="cb63-218"><a href="#cb63-218" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(gapChina, aes(x = year, y = lifeExp)) + geom_point() +</span></span>
<span id="cb63-219"><a href="#cb63-219" aria-hidden="true" tabindex="-1"></a><span class="in">                          ggtitle("China's life expectancy")</span></span>
<span id="cb63-220"><a href="#cb63-220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-221"><a href="#cb63-221" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb63-222"><a href="#cb63-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-223"><a href="#cb63-223" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="X-Y line plots: <span class="in">`geom_line()`</span> or <span class="in">`geom_path()`</span>"}</span>
<span id="cb63-224"><a href="#cb63-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-225"><a href="#cb63-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE, fig.show = "hold"}</span></span>
<span id="cb63-226"><a href="#cb63-226" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(gapChina, aes(x = year, y = lifeExp)) + geom_line() +</span></span>
<span id="cb63-227"><a href="#cb63-227" aria-hidden="true" tabindex="-1"></a><span class="in">                          ggtitle("China's life expectancy")</span></span>
<span id="cb63-228"><a href="#cb63-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-229"><a href="#cb63-229" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb63-230"><a href="#cb63-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-231"><a href="#cb63-231" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Histograms: <span class="in">`geom_histogram()`</span>, <span class="in">`geom_col()`</span>, or <span class="in">`geom_bar()`</span>"}</span>
<span id="cb63-232"><a href="#cb63-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-233"><a href="#cb63-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=""}</span></span>
<span id="cb63-234"><a href="#cb63-234" aria-hidden="true" tabindex="-1"></a><span class="in">gapminder2007 &lt;- gapminder |&gt; filter(year == 2007)</span></span>
<span id="cb63-235"><a href="#cb63-235" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(gapminder2007, aes(x = lifeExp)) + geom_histogram(binwidth = 5) +</span></span>
<span id="cb63-236"><a href="#cb63-236" aria-hidden="true" tabindex="-1"></a><span class="in">                          ggtitle("World's life expectancy")</span></span>
<span id="cb63-237"><a href="#cb63-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-238"><a href="#cb63-238" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb63-239"><a href="#cb63-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-240"><a href="#cb63-240" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Densities: <span class="in">`geom_density()`</span>, <span class="in">`geom_density2d()`</span>"}</span>
<span id="cb63-241"><a href="#cb63-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-242"><a href="#cb63-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE, fig.show = "hold"}</span></span>
<span id="cb63-243"><a href="#cb63-243" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(gapminder2007, aes(x = lifeExp)) + geom_density() + </span></span>
<span id="cb63-244"><a href="#cb63-244" aria-hidden="true" tabindex="-1"></a><span class="in">                          ggtitle("World's life expectancy")</span></span>
<span id="cb63-245"><a href="#cb63-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-246"><a href="#cb63-246" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb63-247"><a href="#cb63-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-248"><a href="#cb63-248" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Boxplots: <span class="in">`geom_boxplot()`</span>"}</span>
<span id="cb63-249"><a href="#cb63-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-250"><a href="#cb63-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE, fig.show = "hold"}</span></span>
<span id="cb63-251"><a href="#cb63-251" aria-hidden="true" tabindex="-1"></a><span class="in"># Notice that here, you must explicitly convert numeric years to factors</span></span>
<span id="cb63-252"><a href="#cb63-252" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder, aes(x = factor(year), y = lifeExp)) +</span></span>
<span id="cb63-253"><a href="#cb63-253" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_boxplot() </span></span>
<span id="cb63-254"><a href="#cb63-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-255"><a href="#cb63-255" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb63-256"><a href="#cb63-256" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Contour plots: <span class="in">`geom_contour()`</span>"}</span>
<span id="cb63-257"><a href="#cb63-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-258"><a href="#cb63-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE, fig.show = "hold"}</span></span>
<span id="cb63-259"><a href="#cb63-259" aria-hidden="true" tabindex="-1"></a><span class="in">data(volcano) # Load volcano contour data</span></span>
<span id="cb63-260"><a href="#cb63-260" aria-hidden="true" tabindex="-1"></a><span class="in">volcano[1:10, 1:10] # Examine volcano dataset (first 10 rows and columns)</span></span>
<span id="cb63-261"><a href="#cb63-261" aria-hidden="true" tabindex="-1"></a><span class="in">volcano3d &lt;- melt(volcano) # Use reshape2 package to melt the data into tidy form</span></span>
<span id="cb63-262"><a href="#cb63-262" aria-hidden="true" tabindex="-1"></a><span class="in">head(volcano3d) # Examine volcano3d dataset (head)</span></span>
<span id="cb63-263"><a href="#cb63-263" aria-hidden="true" tabindex="-1"></a><span class="in">names(volcano3d) &lt;- c("xvar", "yvar", "zvar") # Rename volcano3d columns</span></span>
<span id="cb63-264"><a href="#cb63-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-265"><a href="#cb63-265" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = volcano3d, aes(x = xvar, y = yvar, z = zvar)) +</span></span>
<span id="cb63-266"><a href="#cb63-266" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_contour() </span></span>
<span id="cb63-267"><a href="#cb63-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-268"><a href="#cb63-268" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb63-269"><a href="#cb63-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-270"><a href="#cb63-270" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Tile/Image/Level plots, heatmaps: <span class="in">`geom_tile()`</span>, <span class="in">`geom_rect()`</span>, <span class="in">`geom_raster()`</span>"}</span>
<span id="cb63-271"><a href="#cb63-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-272"><a href="#cb63-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE, fig.show = "hold"}</span></span>
<span id="cb63-273"><a href="#cb63-273" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = volcano3d, aes(x = xvar, y = yvar, z = zvar)) +</span></span>
<span id="cb63-274"><a href="#cb63-274" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_tile(aes(fill = zvar)) </span></span>
<span id="cb63-275"><a href="#cb63-275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-276"><a href="#cb63-276" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb63-277"><a href="#cb63-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-278"><a href="#cb63-278" aria-hidden="true" tabindex="-1"></a><span class="fu">## "Trellis" plots</span></span>
<span id="cb63-279"><a href="#cb63-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-280"><a href="#cb63-280" aria-hidden="true" tabindex="-1"></a>Trellis plots allow you to stratify by a variable, with one panel per categorical value. One uses either <span class="in">`facet_grid()`</span> or <span class="in">`facet_wrap()`</span>:</span>
<span id="cb63-281"><a href="#cb63-281" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb63-282"><a href="#cb63-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE, fig.show = "hold"}</span></span>
<span id="cb63-283"><a href="#cb63-283" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder, aes(x = lifeExp)) + geom_histogram(binwidth = 5) +</span></span>
<span id="cb63-284"><a href="#cb63-284" aria-hidden="true" tabindex="-1"></a><span class="in">            facet_wrap(~year)</span></span>
<span id="cb63-285"><a href="#cb63-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-286"><a href="#cb63-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-287"><a href="#cb63-287" aria-hidden="true" tabindex="-1"></a>This can be quite powerful. It gives you the ability to take account of an additional variable.</span>
<span id="cb63-288"><a href="#cb63-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-289"><a href="#cb63-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-290"><a href="#cb63-290" aria-hidden="true" tabindex="-1"></a><span class="fu">## Anatomy of `aes()`</span></span>
<span id="cb63-291"><a href="#cb63-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-292"><a href="#cb63-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb63-293"><a href="#cb63-293" aria-hidden="true" tabindex="-1"></a><span class="in"># NOT run</span></span>
<span id="cb63-294"><a href="#cb63-294" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = , mapping = aes(x = , y = , color = , linetype = , shape = , size = ))</span></span>
<span id="cb63-295"><a href="#cb63-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-296"><a href="#cb63-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-297"><a href="#cb63-297" aria-hidden="true" tabindex="-1"></a>These four aesthetic parameters (<span class="in">`color`</span>, <span class="in">`linetype`</span>, <span class="in">`shape`</span>, <span class="in">`size`</span>) can be used to show variation in *kind* (categories) and variation in *degree* (numeric).</span>
<span id="cb63-298"><a href="#cb63-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-299"><a href="#cb63-299" aria-hidden="true" tabindex="-1"></a>Parameters passed into <span class="in">`aes`</span> should be *variables* in your dataset.</span>
<span id="cb63-300"><a href="#cb63-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-301"><a href="#cb63-301" aria-hidden="true" tabindex="-1"></a>Parameters passed to <span class="in">`geom_xxx`</span> outside of <span class="in">`aes`</span> should *not* be related to your dataset -- they apply to the whole figure.</span>
<span id="cb63-302"><a href="#cb63-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-303"><a href="#cb63-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE}</span></span>
<span id="cb63-304"><a href="#cb63-304" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder, aes(x = year, y = lifeExp)) +</span></span>
<span id="cb63-305"><a href="#cb63-305" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_line(aes(color = country), show.legend = FALSE)</span></span>
<span id="cb63-306"><a href="#cb63-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-307"><a href="#cb63-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-308"><a href="#cb63-308" aria-hidden="true" tabindex="-1"></a>Note what happens when we specify the color parameter outside of the aesthetic operator. ggplot views these specifications as invalid graphical parameters.</span>
<span id="cb63-309"><a href="#cb63-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-310"><a href="#cb63-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE, error = TRUE}</span></span>
<span id="cb63-311"><a href="#cb63-311" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder, aes(x = year, y = lifeExp)) +</span></span>
<span id="cb63-312"><a href="#cb63-312" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_line(color = country)</span></span>
<span id="cb63-313"><a href="#cb63-313" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder, aes(x = year, y = lifeExp)) +</span></span>
<span id="cb63-314"><a href="#cb63-314" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_line(color = "country")</span></span>
<span id="cb63-315"><a href="#cb63-315" aria-hidden="true" tabindex="-1"></a><span class="in">## This 'works' syntactically but not substantively.</span></span>
<span id="cb63-316"><a href="#cb63-316" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder, aes(x = year, y = lifeExp)) +</span></span>
<span id="cb63-317"><a href="#cb63-317" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_line(color = "red")</span></span>
<span id="cb63-318"><a href="#cb63-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-319"><a href="#cb63-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-320"><a href="#cb63-320" aria-hidden="true" tabindex="-1"></a>**Note:** Aesthetics automatically show up in your legend. Parameters (those not mapped to a  variable in your data frame) do not!</span>
<span id="cb63-321"><a href="#cb63-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-322"><a href="#cb63-322" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using aesthetics to highlight features</span></span>
<span id="cb63-323"><a href="#cb63-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-324"><a href="#cb63-324" aria-hidden="true" tabindex="-1"></a><span class="fu">### Differences in kind</span></span>
<span id="cb63-325"><a href="#cb63-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-326"><a href="#cb63-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE, fig.show = "hold"}</span></span>
<span id="cb63-327"><a href="#cb63-327" aria-hidden="true" tabindex="-1"></a><span class="in">## color as the aesthetic to differentiate by continent</span></span>
<span id="cb63-328"><a href="#cb63-328" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder2007, aes(x = gdpPercap, y = lifeExp)) +</span></span>
<span id="cb63-329"><a href="#cb63-329" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_point(aes(color = continent)) + scale_x_log10()</span></span>
<span id="cb63-330"><a href="#cb63-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-331"><a href="#cb63-331" aria-hidden="true" tabindex="-1"></a><span class="in">## point shape as the aesthetic to differentiate by continent</span></span>
<span id="cb63-332"><a href="#cb63-332" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder2007, aes(x = gdpPercap, y = lifeExp)) +</span></span>
<span id="cb63-333"><a href="#cb63-333" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_point(aes(shape = continent)) + scale_x_log10()</span></span>
<span id="cb63-334"><a href="#cb63-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-335"><a href="#cb63-335" aria-hidden="true" tabindex="-1"></a><span class="in">## line type as the aesthetic to differentiate by country</span></span>
<span id="cb63-336"><a href="#cb63-336" aria-hidden="true" tabindex="-1"></a><span class="in">gapOceania &lt;- gapminder |&gt; filter(continent %in% 'Oceania')</span></span>
<span id="cb63-337"><a href="#cb63-337" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapOceania, aes(x = year, y = lifeExp)) +</span></span>
<span id="cb63-338"><a href="#cb63-338" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_line(aes(linetype = country)) + scale_x_log10()</span></span>
<span id="cb63-339"><a href="#cb63-339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-340"><a href="#cb63-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-341"><a href="#cb63-341" aria-hidden="true" tabindex="-1"></a><span class="fu">### Differences in degree</span></span>
<span id="cb63-342"><a href="#cb63-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-343"><a href="#cb63-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE, fig.show = "hold"}</span></span>
<span id="cb63-344"><a href="#cb63-344" aria-hidden="true" tabindex="-1"></a><span class="in">## point size as the aesthetic to differentiate by population</span></span>
<span id="cb63-345"><a href="#cb63-345" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder2007, aes(x = gdpPercap, y = lifeExp)) +</span></span>
<span id="cb63-346"><a href="#cb63-346" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_point(aes(size = pop)) + scale_x_log10()</span></span>
<span id="cb63-347"><a href="#cb63-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-348"><a href="#cb63-348" aria-hidden="true" tabindex="-1"></a><span class="in">## color as the aesthetic to differentiate by population</span></span>
<span id="cb63-349"><a href="#cb63-349" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder2007, aes(x = gdpPercap, y = lifeExp)) +</span></span>
<span id="cb63-350"><a href="#cb63-350" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_point(aes(color = pop)) + scale_x_log10() +</span></span>
<span id="cb63-351"><a href="#cb63-351" aria-hidden="true" tabindex="-1"></a><span class="in">            scale_color_gradient(low = 'lightgray', high = 'black')</span></span>
<span id="cb63-352"><a href="#cb63-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-353"><a href="#cb63-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-354"><a href="#cb63-354" aria-hidden="true" tabindex="-1"></a><span class="fu">### Multiple non-coordinate aesthetics (differences in kind using color, degree using point size)</span></span>
<span id="cb63-355"><a href="#cb63-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-356"><a href="#cb63-356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE}</span></span>
<span id="cb63-357"><a href="#cb63-357" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder2007, aes(x = gdpPercap, y = lifeExp)) +</span></span>
<span id="cb63-358"><a href="#cb63-358" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_point(aes(size = pop, color = continent)) + scale_x_log10()</span></span>
<span id="cb63-359"><a href="#cb63-359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-360"><a href="#cb63-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-361"><a href="#cb63-361" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="Question"}</span>
<span id="cb63-362"><a href="#cb63-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-363"><a href="#cb63-363" aria-hidden="true" tabindex="-1"></a>How many variables have we represented? If we used a trellis plot we could represent yet another variable!</span>
<span id="cb63-364"><a href="#cb63-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-365"><a href="#cb63-365" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb63-366"><a href="#cb63-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-367"><a href="#cb63-367" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using aesthetics: quick quiz</span></span>
<span id="cb63-368"><a href="#cb63-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-369"><a href="#cb63-369" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="Question"}</span>
<span id="cb63-370"><a href="#cb63-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-371"><a href="#cb63-371" aria-hidden="true" tabindex="-1"></a>Which of these ggplot2 calls will work (in the sense of not giving an error, not in the sense of being a useful plot)?</span>
<span id="cb63-372"><a href="#cb63-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-373"><a href="#cb63-373" aria-hidden="true" tabindex="-1"></a>1) <span class="in">`gapminder |&gt; ggplot(aes(x = gdpPercap, y = lifeExp)) |&gt; geom_point()`</span></span>
<span id="cb63-374"><a href="#cb63-374" aria-hidden="true" tabindex="-1"></a>2) <span class="in">`gapminder |&gt; ggplot(aes(x = gdpPercap, y = lifeExp))`</span></span>
<span id="cb63-375"><a href="#cb63-375" aria-hidden="true" tabindex="-1"></a>3) <span class="in">`gapminder |&gt; ggplot(aes(x = gdpPercap, y = lifeExp)) + geom_point()`</span></span>
<span id="cb63-376"><a href="#cb63-376" aria-hidden="true" tabindex="-1"></a>4) <span class="in">`gapminder |&gt; ggplot(aes(x = gdpPercap, y = lifeExp, shape = 'a')) + geom_point()`</span></span>
<span id="cb63-377"><a href="#cb63-377" aria-hidden="true" tabindex="-1"></a>5) <span class="in">`gapminder |&gt; ggplot(aes(x = gdpPercap, y = lifeExp)) + geom_point(aes(shape = country), show.legend = FALSE)`</span></span>
<span id="cb63-378"><a href="#cb63-378" aria-hidden="true" tabindex="-1"></a>6) <span class="in">`gapminder |&gt; ggplot(aes(x = gdpPercap, y = lifeExp)) + geom_point(shape = 'a', show.legend = FALSE)`</span></span>
<span id="cb63-379"><a href="#cb63-379" aria-hidden="true" tabindex="-1"></a>7) <span class="in">`gapminder |&gt; ggplot() + geom_point(aes(x = gdpPercap, y = lifeExp, shape = country), show.legend = FALSE)`</span></span>
<span id="cb63-380"><a href="#cb63-380" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb63-381"><a href="#cb63-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-382"><a href="#cb63-382" aria-hidden="true" tabindex="-1"></a><span class="fu">## Where do I put `aes()`? (optional)</span></span>
<span id="cb63-383"><a href="#cb63-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-384"><a href="#cb63-384" aria-hidden="true" tabindex="-1"></a>As seen in the code snippets in the quick quiz, one can put <span class="in">`aes()`</span> in the original <span class="in">`ggplot()`</span> call or in latter <span class="in">`geom_x()`</span> calls. What's the difference?</span>
<span id="cb63-385"><a href="#cb63-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-386"><a href="#cb63-386" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If one puts <span class="in">`aes()`</span> in <span class="in">`ggplot()`</span>, it affects all subsequent calls that are part of the same ggplot expression.</span>
<span id="cb63-387"><a href="#cb63-387" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If one puts <span class="in">`aes()`</span> in a <span class="in">`geom_x()`</span>, it affects only that particular component of the plotting.</span>
<span id="cb63-388"><a href="#cb63-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-389"><a href="#cb63-389" aria-hidden="true" tabindex="-1"></a>So where you put it affects the "scope" of what it affects.</span>
<span id="cb63-390"><a href="#cb63-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-393"><a href="#cb63-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-394"><a href="#cb63-394" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">"Oceania"</span>) <span class="sc">|&gt;</span></span>
<span id="cb63-395"><a href="#cb63-395" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> gdpPercap, <span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb63-396"><a href="#cb63-396" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb63-397"><a href="#cb63-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-398"><a href="#cb63-398" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">"Oceania"</span>) <span class="sc">|&gt;</span></span>
<span id="cb63-399"><a href="#cb63-399" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> gdpPercap)) <span class="sc">+</span></span>
<span id="cb63-400"><a href="#cb63-400" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> country)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb63-401"><a href="#cb63-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-402"><a href="#cb63-402" aria-hidden="true" tabindex="-1"></a><span class="co"># Yikes, this doesn't work right:</span></span>
<span id="cb63-403"><a href="#cb63-403" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">"Oceania"</span>) <span class="sc">|&gt;</span></span>
<span id="cb63-404"><a href="#cb63-404" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> gdpPercap)) <span class="sc">+</span></span>
<span id="cb63-405"><a href="#cb63-405" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> country)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span>
<span id="cb63-406"><a href="#cb63-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-407"><a href="#cb63-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-408"><a href="#cb63-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-409"><a href="#cb63-409" aria-hidden="true" tabindex="-1"></a><span class="fu">## Scaling Aesthetics</span></span>
<span id="cb63-410"><a href="#cb63-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-411"><a href="#cb63-411" aria-hidden="true" tabindex="-1"></a>Aesthetics are handled by their very own <span class="in">`scale`</span> functions which allow you to set</span>
<span id="cb63-412"><a href="#cb63-412" aria-hidden="true" tabindex="-1"></a>the limits, breaks, transformations, and any palletes that might determine how you want your </span>
<span id="cb63-413"><a href="#cb63-413" aria-hidden="true" tabindex="-1"></a>data plotted. ggplot includes a number of helpful default scale functions. For example:</span>
<span id="cb63-414"><a href="#cb63-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-415"><a href="#cb63-415" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`scale_x_log10`</span> that can transform your data on the fly</span>
<span id="cb63-416"><a href="#cb63-416" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`scale_color_viridis`</span> uses palettes from the <span class="in">`viridis`</span> package specifically designed to "make plots that are pretty, better represent your data, easier to read by those with colorblindness, and print well in grey scale."</span>
<span id="cb63-417"><a href="#cb63-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-418"><a href="#cb63-418" aria-hidden="true" tabindex="-1"></a>For example, our data might be better represented using a log10 transformation of per capita GDP:</span>
<span id="cb63-421"><a href="#cb63-421" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-422"><a href="#cb63-422" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb63-423"><a href="#cb63-423" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb63-424"><a href="#cb63-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()</span>
<span id="cb63-425"><a href="#cb63-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-426"><a href="#cb63-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-427"><a href="#cb63-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-428"><a href="#cb63-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-429"><a href="#cb63-429" aria-hidden="true" tabindex="-1"></a>And perhaps we want colors that are a little different:</span>
<span id="cb63-432"><a href="#cb63-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-433"><a href="#cb63-433" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb63-434"><a href="#cb63-434" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb63-435"><a href="#cb63-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb63-436"><a href="#cb63-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span>
<span id="cb63-437"><a href="#cb63-437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-438"><a href="#cb63-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-439"><a href="#cb63-439" aria-hidden="true" tabindex="-1"></a>Or perhaps we want to set your palettes and breaks or labels manually: </span>
<span id="cb63-440"><a href="#cb63-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-443"><a href="#cb63-443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-444"><a href="#cb63-444" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb63-445"><a href="#cb63-445" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb63-446"><a href="#cb63-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb63-447"><a href="#cb63-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"The continents"</span>, </span>
<span id="cb63-448"><a href="#cb63-448" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"yellow"</span>, <span class="st">"#800080"</span>)) <span class="co"># hex codes work!</span></span>
<span id="cb63-449"><a href="#cb63-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-450"><a href="#cb63-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-451"><a href="#cb63-451" aria-hidden="true" tabindex="-1"></a>For more info about setting scales in ggplot and for more helper functions</span>
<span id="cb63-452"><a href="#cb63-452" aria-hidden="true" tabindex="-1"></a>consider diving into the <span class="in">`scales`</span> </span>
<span id="cb63-453"><a href="#cb63-453" aria-hidden="true" tabindex="-1"></a>package which is the backend to much of the scales functionality in ggplot</span>
<span id="cb63-454"><a href="#cb63-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-455"><a href="#cb63-455" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fine tuning your plot</span></span>
<span id="cb63-456"><a href="#cb63-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-457"><a href="#cb63-457" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot`</span> handles  many plot options as additional layers.</span>
<span id="cb63-458"><a href="#cb63-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-459"><a href="#cb63-459" aria-hidden="true" tabindex="-1"></a><span class="fu">### Labels</span></span>
<span id="cb63-460"><a href="#cb63-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-461"><a href="#cb63-461" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE, fig.show = "hold"}</span></span>
<span id="cb63-462"><a href="#cb63-462" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder2007, aes(x = gdpPercap, y = lifeExp)) + geom_point() +</span></span>
<span id="cb63-463"><a href="#cb63-463" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab(label = "GDP per capita") +</span></span>
<span id="cb63-464"><a href="#cb63-464" aria-hidden="true" tabindex="-1"></a><span class="in">  ylab(label = "Life expectancy") +</span></span>
<span id="cb63-465"><a href="#cb63-465" aria-hidden="true" tabindex="-1"></a><span class="in">  ggtitle(label = "Gapminder") </span></span>
<span id="cb63-466"><a href="#cb63-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-467"><a href="#cb63-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-468"><a href="#cb63-468" aria-hidden="true" tabindex="-1"></a>Or even more simply use the <span class="in">`labs()`</span> function</span>
<span id="cb63-469"><a href="#cb63-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-470"><a href="#cb63-470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb63-471"><a href="#cb63-471" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder2007, aes(x = gdpPercap, y = lifeExp)) + geom_point() +</span></span>
<span id="cb63-472"><a href="#cb63-472" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "GDP per capita", y = "Life expectancy", title = "Gapminder")</span></span>
<span id="cb63-473"><a href="#cb63-473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-474"><a href="#cb63-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-475"><a href="#cb63-475" aria-hidden="true" tabindex="-1"></a><span class="fu">### Axis and point scales</span></span>
<span id="cb63-476"><a href="#cb63-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-477"><a href="#cb63-477" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE, fig.show = "hold"}</span></span>
<span id="cb63-478"><a href="#cb63-478" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder, aes(x = gdpPercap, y = lifeExp)) +</span></span>
<span id="cb63-479"><a href="#cb63-479" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_point() </span></span>
<span id="cb63-480"><a href="#cb63-480" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder, aes(x = gdpPercap, y = lifeExp)) +</span></span>
<span id="cb63-481"><a href="#cb63-481" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_point(size=3) </span></span>
<span id="cb63-482"><a href="#cb63-482" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder, aes(x = gdpPercap, y = lifeExp)) +</span></span>
<span id="cb63-483"><a href="#cb63-483" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_point(size=1) </span></span>
<span id="cb63-484"><a href="#cb63-484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-485"><a href="#cb63-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-486"><a href="#cb63-486" aria-hidden="true" tabindex="-1"></a><span class="fu">### Colors</span></span>
<span id="cb63-487"><a href="#cb63-487" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE, fig.show = "hold"}</span></span>
<span id="cb63-488"><a href="#cb63-488" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder, aes(x = gdpPercap, y = lifeExp)) +</span></span>
<span id="cb63-489"><a href="#cb63-489" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_point(color = colors()[11]) </span></span>
<span id="cb63-490"><a href="#cb63-490" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder, aes(x = gdpPercap, y = lifeExp)) +</span></span>
<span id="cb63-491"><a href="#cb63-491" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_point(color = "red") </span></span>
<span id="cb63-492"><a href="#cb63-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-493"><a href="#cb63-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-494"><a href="#cb63-494" aria-hidden="true" tabindex="-1"></a><span class="fu">### Point Styles and Widths</span></span>
<span id="cb63-495"><a href="#cb63-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-496"><a href="#cb63-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE, fig.show = "hold"}</span></span>
<span id="cb63-497"><a href="#cb63-497" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder, aes(x = gdpPercap, y = lifeExp)) +</span></span>
<span id="cb63-498"><a href="#cb63-498" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_point(shape = 3) </span></span>
<span id="cb63-499"><a href="#cb63-499" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder, aes(x = gdpPercap, y = lifeExp)) +</span></span>
<span id="cb63-500"><a href="#cb63-500" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_point(shape = "w") </span></span>
<span id="cb63-501"><a href="#cb63-501" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapminder, aes(x = gdpPercap, y = lifeExp)) +</span></span>
<span id="cb63-502"><a href="#cb63-502" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_point(shape = "$", size=5) </span></span>
<span id="cb63-503"><a href="#cb63-503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-504"><a href="#cb63-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-505"><a href="#cb63-505" aria-hidden="true" tabindex="-1"></a><span class="fu">### Line Styles and Widths</span></span>
<span id="cb63-506"><a href="#cb63-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-507"><a href="#cb63-507" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap=" ", warning=FALSE, fig.show = "hold"}</span></span>
<span id="cb63-508"><a href="#cb63-508" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapChina, aes(x = year, y = lifeExp)) +</span></span>
<span id="cb63-509"><a href="#cb63-509" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_line(linetype = 1) </span></span>
<span id="cb63-510"><a href="#cb63-510" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapChina, aes(x = year, y = lifeExp)) +</span></span>
<span id="cb63-511"><a href="#cb63-511" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_line(linetype = 2) </span></span>
<span id="cb63-512"><a href="#cb63-512" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = gapChina, aes(x = year, y = lifeExp)) +</span></span>
<span id="cb63-513"><a href="#cb63-513" aria-hidden="true" tabindex="-1"></a><span class="in">            geom_line(linetype = 5, size = 2) </span></span>
<span id="cb63-514"><a href="#cb63-514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-515"><a href="#cb63-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-516"><a href="#cb63-516" aria-hidden="true" tabindex="-1"></a><span class="fu">## Themes with `ggplot2` (optional)</span></span>
<span id="cb63-517"><a href="#cb63-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-518"><a href="#cb63-518" aria-hidden="true" tabindex="-1"></a>Elements of the plot *not associated with geometries* can be adjusted using ggplot</span>
<span id="cb63-519"><a href="#cb63-519" aria-hidden="true" tabindex="-1"></a>*themes*. </span>
<span id="cb63-520"><a href="#cb63-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-521"><a href="#cb63-521" aria-hidden="true" tabindex="-1"></a>There are some "complete" themes already included with the package:</span>
<span id="cb63-522"><a href="#cb63-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-523"><a href="#cb63-523" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`theme_gray()`</span> (the default)</span>
<span id="cb63-524"><a href="#cb63-524" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`theme_minimal()`</span></span>
<span id="cb63-525"><a href="#cb63-525" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`theme_bw()`</span></span>
<span id="cb63-526"><a href="#cb63-526" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`theme_light()`</span></span>
<span id="cb63-527"><a href="#cb63-527" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`theme_dark()`</span></span>
<span id="cb63-528"><a href="#cb63-528" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`theme_classic()`</span></span>
<span id="cb63-529"><a href="#cb63-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-530"><a href="#cb63-530" aria-hidden="true" tabindex="-1"></a>But in additional to these, you can tweak just about any element of your plot's </span>
<span id="cb63-531"><a href="#cb63-531" aria-hidden="true" tabindex="-1"></a>appearance using the <span class="in">`theme()`</span> function. </span>
<span id="cb63-532"><a href="#cb63-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-533"><a href="#cb63-533" aria-hidden="true" tabindex="-1"></a>For instance, perhaps you want to move the legend from the left to the bottom of </span>
<span id="cb63-534"><a href="#cb63-534" aria-hidden="true" tabindex="-1"></a>your plot, this would be part of the plot theme. Note how you can add options to a complete theme already in the plot:</span>
<span id="cb63-535"><a href="#cb63-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-538"><a href="#cb63-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-539"><a href="#cb63-539" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span></span>
<span id="cb63-540"><a href="#cb63-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"China"</span>, <span class="st">"Turkey"</span>, <span class="st">"Italy"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb63-541"><a href="#cb63-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb63-542"><a href="#cb63-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb63-543"><a href="#cb63-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb63-544"><a href="#cb63-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb63-545"><a href="#cb63-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-546"><a href="#cb63-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-547"><a href="#cb63-547" aria-hidden="true" tabindex="-1"></a><span class="fu">## Combining Multiple Plots</span></span>
<span id="cb63-548"><a href="#cb63-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-549"><a href="#cb63-549" aria-hidden="true" tabindex="-1"></a>ggplot graphs can be combined using the <span class="in">`grid.arrange()`</span> function in the <span class="in">`gridExtra`</span> package. This takes advantage of each plot being an object.</span>
<span id="cb63-550"><a href="#cb63-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-551"><a href="#cb63-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, fig.cap=" "}</span></span>
<span id="cb63-552"><a href="#cb63-552" aria-hidden="true" tabindex="-1"></a><span class="in">library(gridExtra)</span></span>
<span id="cb63-553"><a href="#cb63-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-554"><a href="#cb63-554" aria-hidden="true" tabindex="-1"></a><span class="in"># Create 3 plots to combine in a table</span></span>
<span id="cb63-555"><a href="#cb63-555" aria-hidden="true" tabindex="-1"></a><span class="in">plot1 &lt;- ggplot(data = gapminder2007, aes(x = gdpPercap, y = lifeExp)) +</span></span>
<span id="cb63-556"><a href="#cb63-556" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point() + scale_x_log10() + annotate('text', 150, 80, label = '(a)')</span></span>
<span id="cb63-557"><a href="#cb63-557" aria-hidden="true" tabindex="-1"></a><span class="in">plot2 &lt;- ggplot(data = gapminder2007, aes(x = pop, y = lifeExp)) +</span></span>
<span id="cb63-558"><a href="#cb63-558" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point() + scale_x_log10() + annotate('text', 1.8e5, 80, label = '(b)')</span></span>
<span id="cb63-559"><a href="#cb63-559" aria-hidden="true" tabindex="-1"></a><span class="in">plot3 &lt;- ggplot(data = gapminder, aes(x = year, y = lifeExp)) +</span></span>
<span id="cb63-560"><a href="#cb63-560" aria-hidden="true" tabindex="-1"></a><span class="in">      geom_line(aes(color = country), show.legend = FALSE) +</span></span>
<span id="cb63-561"><a href="#cb63-561" aria-hidden="true" tabindex="-1"></a><span class="in">      annotate('text', 1951, 80, label = '(c)')</span></span>
<span id="cb63-562"><a href="#cb63-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-563"><a href="#cb63-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-564"><a href="#cb63-564" aria-hidden="true" tabindex="-1"></a><span class="in"># Call grid.arrange</span></span>
<span id="cb63-565"><a href="#cb63-565" aria-hidden="true" tabindex="-1"></a><span class="in">grid.arrange(plot1, plot2, plot3, nrow=3, ncol = 1)</span></span>
<span id="cb63-566"><a href="#cb63-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-567"><a href="#cb63-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-568"><a href="#cb63-568" aria-hidden="true" tabindex="-1"></a><span class="fu">## `patchwork`: Combining Multiple ggplot plots (optional)</span></span>
<span id="cb63-569"><a href="#cb63-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-570"><a href="#cb63-570" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The <span class="in">`patchwork`</span> package may be used to combine multiple ggplot plots using</span>
<span id="cb63-571"><a href="#cb63-571" aria-hidden="true" tabindex="-1"></a>  a small set of operators similar to the pipe.</span>
<span id="cb63-572"><a href="#cb63-572" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>This requires less syntax than using <span class="in">`gridExtra`</span> and allows complex</span>
<span id="cb63-573"><a href="#cb63-573" aria-hidden="true" tabindex="-1"></a>  arrangements to be built nearly effortlessly.</span>
<span id="cb63-574"><a href="#cb63-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-575"><a href="#cb63-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, fig.cap=" ", fig.width=12}</span></span>
<span id="cb63-576"><a href="#cb63-576" aria-hidden="true" tabindex="-1"></a><span class="in">library(patchwork)</span></span>
<span id="cb63-577"><a href="#cb63-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-578"><a href="#cb63-578" aria-hidden="true" tabindex="-1"></a><span class="in"># use the patchwork operators</span></span>
<span id="cb63-579"><a href="#cb63-579" aria-hidden="true" tabindex="-1"></a><span class="in"># stack plots horizontally</span></span>
<span id="cb63-580"><a href="#cb63-580" aria-hidden="true" tabindex="-1"></a><span class="in">plot1 + plot2 + plot3</span></span>
<span id="cb63-581"><a href="#cb63-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-582"><a href="#cb63-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-583"><a href="#cb63-583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, fig.cap=" ", fig.width=12}</span></span>
<span id="cb63-584"><a href="#cb63-584" aria-hidden="true" tabindex="-1"></a><span class="in"># stack plots vertically</span></span>
<span id="cb63-585"><a href="#cb63-585" aria-hidden="true" tabindex="-1"></a><span class="in">plot1 / plot2 / plot3</span></span>
<span id="cb63-586"><a href="#cb63-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-587"><a href="#cb63-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-588"><a href="#cb63-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, fig.cap=" ", fig.width=12}</span></span>
<span id="cb63-589"><a href="#cb63-589" aria-hidden="true" tabindex="-1"></a><span class="in"># side-by-side plots with third plot below</span></span>
<span id="cb63-590"><a href="#cb63-590" aria-hidden="true" tabindex="-1"></a><span class="in">(plot1 | plot2) / plot3</span></span>
<span id="cb63-591"><a href="#cb63-591" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-592"><a href="#cb63-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-593"><a href="#cb63-593" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, fig.cap=" ", fig.width=12}</span></span>
<span id="cb63-594"><a href="#cb63-594" aria-hidden="true" tabindex="-1"></a><span class="in"># side-by-side plots with a space in between, and a third plot below</span></span>
<span id="cb63-595"><a href="#cb63-595" aria-hidden="true" tabindex="-1"></a><span class="in">(plot1 | plot_spacer() | plot2) / plot3</span></span>
<span id="cb63-596"><a href="#cb63-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-597"><a href="#cb63-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-598"><a href="#cb63-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, fig.cap=" ", fig.width=12}</span></span>
<span id="cb63-599"><a href="#cb63-599" aria-hidden="true" tabindex="-1"></a><span class="in"># stack plots vertically and alter with a single "gg_theme"</span></span>
<span id="cb63-600"><a href="#cb63-600" aria-hidden="true" tabindex="-1"></a><span class="in">(plot1 / plot2 / plot3) &amp; theme_bw()</span></span>
<span id="cb63-601"><a href="#cb63-601" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-602"><a href="#cb63-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-603"><a href="#cb63-603" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="ggplot extensions"}</span>
<span id="cb63-604"><a href="#cb63-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-605"><a href="#cb63-605" aria-hidden="true" tabindex="-1"></a><span class="in">`patchwork`</span> is an example of a ggplot2 extension package of which there are many! One of the benefits to learning and using ggplot is that there is a huge community of developers that build separate graphics packages that generally use the same syntax to extend the <span class="in">`ggplot2`</span> functionality into things like animation and 3D plotting! <span class="co">[</span><span class="ot">Check them out here</span><span class="co">](http://www.ggplot2-exts.org/gallery/)</span>.</span>
<span id="cb63-606"><a href="#cb63-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-607"><a href="#cb63-607" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb63-608"><a href="#cb63-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-609"><a href="#cb63-609" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exporting</span></span>
<span id="cb63-610"><a href="#cb63-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-611"><a href="#cb63-611" aria-hidden="true" tabindex="-1"></a>There are two basic image formats: raster and vector. </span>
<span id="cb63-612"><a href="#cb63-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-613"><a href="#cb63-613" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Raster/Bitmap** (.png, .jpeg)</span></span>
<span id="cb63-614"><a href="#cb63-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-615"><a href="#cb63-615" aria-hidden="true" tabindex="-1"></a>Every pixel of a plot contains its own separate coding:</span>
<span id="cb63-616"><a href="#cb63-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-617"><a href="#cb63-617" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>sensible for gridded/raster output</span>
<span id="cb63-618"><a href="#cb63-618" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>**bad if you want to resize the image**</span>
<span id="cb63-619"><a href="#cb63-619" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>file size depends on pixel resolution</span>
<span id="cb63-620"><a href="#cb63-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-621"><a href="#cb63-621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb63-622"><a href="#cb63-622" aria-hidden="true" tabindex="-1"></a><span class="in">jpeg(filename = "example.jpg", width = , height =)</span></span>
<span id="cb63-623"><a href="#cb63-623" aria-hidden="true" tabindex="-1"></a><span class="in">plot(x,y)</span></span>
<span id="cb63-624"><a href="#cb63-624" aria-hidden="true" tabindex="-1"></a><span class="in">dev.off()</span></span>
<span id="cb63-625"><a href="#cb63-625" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-626"><a href="#cb63-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-627"><a href="#cb63-627" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Vector** (.pdf, .ps)</span></span>
<span id="cb63-628"><a href="#cb63-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-629"><a href="#cb63-629" aria-hidden="true" tabindex="-1"></a>Every element of a plot is encoded as a representation of its shape</span>
<span id="cb63-630"><a href="#cb63-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-631"><a href="#cb63-631" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>**great for resizing**</span>
<span id="cb63-632"><a href="#cb63-632" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>image files with many elements can be very large.</span>
<span id="cb63-633"><a href="#cb63-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-634"><a href="#cb63-634" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb63-635"><a href="#cb63-635" aria-hidden="true" tabindex="-1"></a><span class="in">pdf(file = "example.pdf", width = , height =)</span></span>
<span id="cb63-636"><a href="#cb63-636" aria-hidden="true" tabindex="-1"></a><span class="in">plot(x,y)</span></span>
<span id="cb63-637"><a href="#cb63-637" aria-hidden="true" tabindex="-1"></a><span class="in">dev.off()</span></span>
<span id="cb63-638"><a href="#cb63-638" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-639"><a href="#cb63-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-640"><a href="#cb63-640" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exporting with `ggplot`</span></span>
<span id="cb63-641"><a href="#cb63-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-642"><a href="#cb63-642" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb63-643"><a href="#cb63-643" aria-hidden="true" tabindex="-1"></a><span class="in"># Assume we saved our plot as an object called `plot1`.</span></span>
<span id="cb63-644"><a href="#cb63-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-645"><a href="#cb63-645" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(filename = "example.pdf", plot = plot1, scale = , width = , height = )</span></span>
<span id="cb63-646"><a href="#cb63-646" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-647"><a href="#cb63-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-648"><a href="#cb63-648" aria-hidden="true" tabindex="-1"></a><span class="fu"># Breakout</span></span>
<span id="cb63-649"><a href="#cb63-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-650"><a href="#cb63-650" aria-hidden="true" tabindex="-1"></a>These questions ask you to work with the gapminder dataset.</span>
<span id="cb63-651"><a href="#cb63-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-652"><a href="#cb63-652" aria-hidden="true" tabindex="-1"></a><span class="fu">## Basics</span></span>
<span id="cb63-653"><a href="#cb63-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-654"><a href="#cb63-654" aria-hidden="true" tabindex="-1"></a>1) Plot a histogram of life expectancy. </span>
<span id="cb63-655"><a href="#cb63-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-656"><a href="#cb63-656" aria-hidden="true" tabindex="-1"></a>2) Plot the gdp per capita against population. Put the x-axis on the log scale.</span>
<span id="cb63-657"><a href="#cb63-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-658"><a href="#cb63-658" aria-hidden="true" tabindex="-1"></a>3) Clean up your scatterplot with a title and axis labels. Output it as a PDF and see if you'd be comfortable with including it in a report/paper.</span>
<span id="cb63-659"><a href="#cb63-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-660"><a href="#cb63-660" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using the ideas</span></span>
<span id="cb63-661"><a href="#cb63-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-662"><a href="#cb63-662" aria-hidden="true" tabindex="-1"></a>4) Create a trellis plot of life expectancy by gdpPercap scatterplots, one subplot per continent. Use a 2x3 layout of panels in the plot. Now have the size of the points vary with population. Use <span class="in">`coord_cartesian()`</span> (or <span class="in">`scale_x_continuous(`</span>) to set the x-axis limits to be in the range from 100 to 50000.</span>
<span id="cb63-663"><a href="#cb63-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-664"><a href="#cb63-664" aria-hidden="true" tabindex="-1"></a>5) Make a boxplot of life expectancy conditional on binned values of gdp per capita.</span>
<span id="cb63-665"><a href="#cb63-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-666"><a href="#cb63-666" aria-hidden="true" tabindex="-1"></a><span class="fu">## Advanced</span></span>
<span id="cb63-667"><a href="#cb63-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-668"><a href="#cb63-668" aria-hidden="true" tabindex="-1"></a>6) Try to create a facsimile of the <span class="co">[</span><span class="ot">famous Gapminder plot</span><span class="co">](https://s3-eu-west-1.amazonaws.com/static.gapminder.org/GapminderMedia/wp-uploads/20161019161829/screenshot2016.jpg)</span> without looking at my code by using a ChatBot, providing it with information about the gapminder dataframe. For simplicity just try to create a static image  (ignoring the 'play' button at bottom) for a single year such as 2007.</span>
<span id="cb63-669"><a href="#cb63-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-670"><a href="#cb63-670" aria-hidden="true" tabindex="-1"></a>7) Alternatively (to #6), using the data for 2007, but *without* using a ChatBot, recreate as much as you can of the <span class="co">[</span><span class="ot">famous Gapminder plot</span><span class="co">](https://s3-eu-west-1.amazonaws.com/static.gapminder.org/GapminderMedia/wp-uploads/20161019161829/screenshot2016.jpg)</span>. For simplicity just try to create a static image  (ignoring the 'play' button at bottom) for a single year such as 2007. </span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>