<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Basic Analysis/Useful Packages</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-2eb2de9d08919211f8a1d749abb3db00.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../assets/styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../units/intro.html">Modules (a partial set)</a></li><li class="breadcrumb-item"><a href="../units/analysis.html">Basic Analysis/Useful Packages</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Voleon R Bootcamp</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/paciorek/r-voleon-2025" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home / Schedule</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preparation</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Modules (a partial set)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Introduction (Module “0”)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Structures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/calculation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calculation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Wrangling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plotting (ggplot)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Basic Analysis/Useful Packages</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#inferenceregression" id="toc-inferenceregression" class="nav-link active" data-scroll-target="#inferenceregression">Inference/Regression</a>
  <ul class="collapse">
  <li><a href="#regression-output" id="toc-regression-output" class="nav-link" data-scroll-target="#regression-output">Regression output</a>
  <ul class="collapse">
  <li><a href="#basic-output-in-an-s3-object" id="toc-basic-output-in-an-s3-object" class="nav-link" data-scroll-target="#basic-output-in-an-s3-object">Basic output in an S3 object</a></li>
  <li><a href="#summary-method-for-regression" id="toc-summary-method-for-regression" class="nav-link" data-scroll-target="#summary-method-for-regression">Summary method for regression</a></li>
  </ul></li>
  <li><a href="#setting-up-regression-interactions" id="toc-setting-up-regression-interactions" class="nav-link" data-scroll-target="#setting-up-regression-interactions">Setting up regression interactions</a></li>
  </ul></li>
  <li><a href="#smoothing" id="toc-smoothing" class="nav-link" data-scroll-target="#smoothing">Smoothing</a>
  <ul class="collapse">
  <li><a href="#mgcvgam-in-action" id="toc-mgcvgam-in-action" class="nav-link" data-scroll-target="#mgcvgam-in-action"><code>mgcv::gam</code> in action</a></li>
  <li><a href="#how-does-gam-choose-how-much-to-smooth" id="toc-how-does-gam-choose-how-much-to-smooth" class="nav-link" data-scroll-target="#how-does-gam-choose-how-much-to-smooth">How does GAM choose how much to smooth?</a></li>
  </ul></li>
  <li><a href="#distributions" id="toc-distributions" class="nav-link" data-scroll-target="#distributions">Distributions</a>
  <ul class="collapse">
  <li><a href="#distributions-in-action" id="toc-distributions-in-action" class="nav-link" data-scroll-target="#distributions-in-action">Distributions in action</a></li>
  <li><a href="#sampling-from-a-finite-set" id="toc-sampling-from-a-finite-set" class="nav-link" data-scroll-target="#sampling-from-a-finite-set">Sampling from a finite set</a></li>
  <li><a href="#the-random-seed" id="toc-the-random-seed" class="nav-link" data-scroll-target="#the-random-seed">The Random Seed</a></li>
  </ul></li>
  <li><a href="#optimization" id="toc-optimization" class="nav-link" data-scroll-target="#optimization">Optimization</a></li>
  <li><a href="#dates-and-times" id="toc-dates-and-times" class="nav-link" data-scroll-target="#dates-and-times">Dates and Times</a>
  <ul class="collapse">
  <li><a href="#dates" id="toc-dates" class="nav-link" data-scroll-target="#dates">Dates</a></li>
  </ul></li>
  <li><a href="#time" id="toc-time" class="nav-link" data-scroll-target="#time">Time</a></li>
  <li><a href="#breakout" id="toc-breakout" class="nav-link" data-scroll-target="#breakout">Breakout</a>
  <ul class="collapse">
  <li><a href="#basics" id="toc-basics" class="nav-link" data-scroll-target="#basics">Basics</a></li>
  <li><a href="#using-the-ideas" id="toc-using-the-ideas" class="nav-link" data-scroll-target="#using-the-ideas">Using the ideas</a></li>
  <li><a href="#advanced" id="toc-advanced" class="nav-link" data-scroll-target="#advanced">Advanced</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../units/intro.html">Modules (a partial set)</a></li><li class="breadcrumb-item"><a href="../units/analysis.html">Basic Analysis/Useful Packages</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Basic Analysis/Useful Packages</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="inferenceregression" class="level1">
<h1>Inference/Regression</h1>
<ul>
<li><p><em>glm</em> fits a generalized linear model with your choice of family/link function (Gaussian, logit, Poisson, etc.)</p>
<ul>
<li><em>lm</em> is just a standard linear regression (equivalent to glm with family = gaussian(link = “identity”))</li>
</ul></li>
<li><p>The basic glm call looks something like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> ..., <span class="at">family =</span> <span class="fu">familyname</span>(<span class="at">link =</span> <span class="st">"linkname"</span>),</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>There are a bunch of families and links to use (help(family) for a full list), but some essentials are:</p>
<ul>
<li><code>binomial(link = "logit")</code></li>
<li><code>gaussian(link = "identity")</code></li>
<li><code>poisson(link = "log")</code></li>
</ul>
<p>If you’re using <code>lm</code>, the call looks the same but without the <code>family</code> argument.</p></li>
<li><p>Example: suppose we want to regress the life expectency on the GDP per capita and the population, as well as the continent and year. The lm/glm call would be something like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> lifeExp <span class="sc">~</span> <span class="fu">log</span>(gdpPercap) <span class="sc">+</span> <span class="fu">log</span>(pop) <span class="sc">+</span> continent <span class="sc">+</span> year, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> gapminder)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ul>
<section id="regression-output" class="level2">
<h2 class="anchored" data-anchor-id="regression-output">Regression output</h2>
<section id="basic-output-in-an-s3-object" class="level3">
<h3 class="anchored" data-anchor-id="basic-output-in-an-s3-object">Basic output in an S3 object</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View components contained in the regression output</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "coefficients"  "residuals"     "effects"       "rank"         
 [5] "fitted.values" "assign"        "qr"            "df.residual"  
 [9] "contrasts"     "xlevels"       "call"          "terms"        
[13] "model"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine regression coefficients</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>reg<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      (Intercept)    log(gdpPercap)          log(pop) continentAmericas 
     -460.8132741         5.0756110         0.1530312         8.7453560 
    continentAsia   continentEurope  continentOceania              year 
        6.8254916        12.2808442        12.5398669         0.2377202 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine regression degrees of freedom</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>reg<span class="sc">$</span>df.residual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1696</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See the standard (diagnostic) plots for a regression</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-3-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-method-for-regression" class="level3">
<h3 class="anchored" data-anchor-id="summary-method-for-regression">Summary method for regression</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lifeExp ~ log(gdpPercap) + log(pop) + continent + 
    year, data = gapminder)

Residuals:
     Min       1Q   Median       3Q      Max 
-25.0572  -3.2857   0.3289   3.7062  15.0650 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       -4.608e+02  1.697e+01 -27.154   &lt;2e-16 ***
log(gdpPercap)     5.076e+00  1.627e-01  31.191   &lt;2e-16 ***
log(pop)           1.530e-01  9.668e-02   1.583    0.114    
continentAmericas  8.745e+00  4.766e-01  18.349   &lt;2e-16 ***
continentAsia      6.825e+00  4.232e-01  16.128   &lt;2e-16 ***
continentEurope    1.228e+01  5.292e-01  23.205   &lt;2e-16 ***
continentOceania   1.254e+01  1.281e+00   9.788   &lt;2e-16 ***
year               2.377e-01  8.932e-03  26.614   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.811 on 1696 degrees of freedom
Multiple R-squared:  0.7985,    Adjusted R-squared:  0.7976 
F-statistic:   960 on 7 and 1696 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>One can also extract useful things from the summary object</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store summary method results</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>summ_reg <span class="ot">&lt;-</span> <span class="fu">summary</span>(reg)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># View summary method results objects</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(summ_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "adj.r.squared" "aliased"       "call"          "coefficients" 
 [5] "cov.unscaled"  "df"            "fstatistic"    "r.squared"    
 [9] "residuals"     "sigma"         "terms"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View table of coefficients</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>summ_reg<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Estimate   Std. Error    t value      Pr(&gt;|t|)
(Intercept)       -460.8132741 16.970277820 -27.154138 3.961833e-135
log(gdpPercap)       5.0756110  0.162724177  31.191499 3.371693e-169
log(pop)             0.1530312  0.096677948   1.582897  1.136315e-01
continentAmericas    8.7453560  0.476599244  18.349496  9.605994e-69
continentAsia        6.8254916  0.423203644  16.128149  1.492420e-54
continentEurope     12.2808442  0.529239698  23.204692 1.123344e-103
continentOceania    12.5398669  1.281141831   9.788040  4.798636e-22
year                 0.2377202  0.008932106  26.614126 1.058968e-130</code></pre>
</div>
</div>
<p>Note that, in our results, R has broken up our variables into their different factor levels (as it will do whenever your regressors have factor levels)</p>
<p>If your data aren’t factorized, you can tell lm/glm to <em>factorize</em> a variable (i.e.&nbsp;create dummy variables on the fly), e.g.:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> <span class="fu">factor</span>(x3), <span class="at">family =</span> <span class="fu">family</span>(<span class="at">link =</span> <span class="st">"link"</span>),</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="setting-up-regression-interactions" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-regression-interactions">Setting up regression interactions</h2>
<p>There are also some useful shortcuts for regressing on interaction terms:</p>
<p><code>x1:x2</code> interacts all terms in x1 with all terms in x2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> <span class="fu">log</span>(gdpPercap) <span class="sc">+</span> <span class="fu">log</span>(pop) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                    continent<span class="sc">:</span><span class="fu">factor</span>(year), </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> gapminder))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lifeExp ~ log(gdpPercap) + log(pop) + continent:factor(year), 
    data = gapminder)

Residuals:
     Min       1Q   Median       3Q      Max 
-26.5678  -2.5530   0.0044   2.9146  15.5667 

Coefficients: (1 not defined because of singularities)
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         27.18384    4.68490   5.802 7.83e-09 ***
log(gdpPercap)                       5.07950    0.16049  31.650  &lt; 2e-16 ***
log(pop)                             0.07894    0.09427   0.837 0.402510    
continentAfrica:factor(year)1952   -24.14252    4.11250  -5.871 5.25e-09 ***
continentAmericas:factor(year)1952 -16.44650    4.16627  -3.948 8.23e-05 ***
continentAsia:factor(year)1952     -19.33470    4.14083  -4.669 3.27e-06 ***
continentEurope:factor(year)1952    -7.09176    4.13518  -1.715 0.086537 .  
continentOceania:factor(year)1952   -6.06350    5.65111  -1.073 0.283440    
continentAfrica:factor(year)1957   -22.49637    4.10985  -5.474 5.09e-08 ***
continentAmericas:factor(year)1957 -14.36734    4.16433  -3.450 0.000575 ***
continentAsia:factor(year)1957     -17.17434    4.13753  -4.151 3.48e-05 ***
continentEurope:factor(year)1957    -5.90941    4.13272  -1.430 0.152934    
continentOceania:factor(year)1957   -5.62997    5.65034  -0.996 0.319206    
continentAfrica:factor(year)1962   -21.01387    4.10690  -5.117 3.47e-07 ***
continentAmericas:factor(year)1962 -12.31354    4.16305  -2.958 0.003143 ** 
continentAsia:factor(year)1962     -15.56258    4.13513  -3.764 0.000173 ***
continentEurope:factor(year)1962    -5.05421    4.13082  -1.224 0.221302    
continentOceania:factor(year)1962   -5.31223    5.64979  -0.940 0.347226    
continentAfrica:factor(year)1967   -19.70336    4.10348  -4.802 1.72e-06 ***
continentAmericas:factor(year)1967 -10.93238    4.16129  -2.627 0.008690 ** 
continentAsia:factor(year)1967     -13.15690    4.13270  -3.184 0.001482 ** 
continentEurope:factor(year)1967    -4.91343    4.12905  -1.190 0.234232    
continentOceania:factor(year)1967   -5.77117    5.64916  -1.022 0.307122    
continentAfrica:factor(year)1972   -18.14692    4.10075  -4.425 1.03e-05 ***
continentAmericas:factor(year)1972  -9.65366    4.15954  -2.321 0.020417 *  
continentAsia:factor(year)1972     -11.60139    4.12929  -2.810 0.005020 ** 
continentEurope:factor(year)1972    -4.97628    4.12753  -1.206 0.228133    
continentOceania:factor(year)1972   -5.80936    5.64868  -1.028 0.303891    
continentAfrica:factor(year)1977   -16.18475    4.09960  -3.948 8.22e-05 ***
continentAmericas:factor(year)1977  -8.33819    4.15801  -2.005 0.045092 *  
continentAsia:factor(year)1977     -10.12201    4.12699  -2.453 0.014285 *  
continentEurope:factor(year)1977    -4.55230    4.12667  -1.103 0.270128    
continentOceania:factor(year)1977   -5.12322    5.64848  -0.907 0.364535    
continentAfrica:factor(year)1982   -14.19333    4.09899  -3.463 0.000549 ***
continentAmericas:factor(year)1982  -6.59214    4.15772  -1.586 0.113041    
continentAsia:factor(year)1982      -7.60009    4.12571  -1.842 0.065636 .  
continentEurope:factor(year)1982    -4.11846    4.12623  -0.998 0.318370    
continentOceania:factor(year)1982   -4.05526    5.64827  -0.718 0.472882    
continentAfrica:factor(year)1987   -12.18504    4.09947  -2.972 0.002998 ** 
continentAmericas:factor(year)1987  -4.71568    4.15765  -1.134 0.256870    
continentAsia:factor(year)1987      -5.69142    4.12491  -1.380 0.167846    
continentEurope:factor(year)1987    -3.72976    4.12583  -0.904 0.366126    
continentOceania:factor(year)1987   -3.51642    5.64805  -0.623 0.533640    
continentAfrica:factor(year)1992   -11.80275    4.09942  -2.879 0.004039 ** 
continentAmericas:factor(year)1992  -3.28548    4.15749  -0.790 0.429492    
continentAsia:factor(year)1992      -4.38228    4.12405  -1.063 0.288113    
continentEurope:factor(year)1992    -2.51508    4.12618  -0.610 0.542249    
continentOceania:factor(year)1992   -1.98041    5.64799  -0.351 0.725904    
continentAfrica:factor(year)1997   -11.95773    4.09861  -2.918 0.003576 ** 
continentAmericas:factor(year)1997  -2.16110    4.15661  -0.520 0.603190    
continentAsia:factor(year)1997      -3.50157    4.12279  -0.849 0.395826    
continentEurope:factor(year)1997    -2.08430    4.12564  -0.505 0.613482    
continentOceania:factor(year)1997   -1.44783    5.64778  -0.256 0.797710    
continentAfrica:factor(year)2002   -12.52375    4.09722  -3.057 0.002274 ** 
continentAmericas:factor(year)2002  -0.98980    4.15641  -0.238 0.811804    
continentAsia:factor(year)2002      -2.67982    4.12205  -0.650 0.515707    
continentEurope:factor(year)2002    -1.57345    4.12518  -0.381 0.702937    
continentOceania:factor(year)2002   -0.47345    5.64768  -0.084 0.933201    
continentAfrica:factor(year)2007   -11.65685    4.09478  -2.847 0.004472 ** 
continentAmericas:factor(year)2007  -0.69311    4.15497  -0.167 0.867536    
continentAsia:factor(year)2007      -2.20076    4.12023  -0.534 0.593320    
continentEurope:factor(year)2007    -1.52841    4.12475  -0.371 0.711024    
continentOceania:factor(year)2007         NA         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.648 on 1642 degrees of freedom
Multiple R-squared:  0.8157,    Adjusted R-squared:  0.8088 
F-statistic: 119.1 on 61 and 1642 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><code>x1*x2</code> produces the cross of x1 and x2, or x1+x2+x1:x2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> <span class="fu">log</span>(gdpPercap) <span class="sc">+</span> <span class="fu">log</span>(pop) <span class="sc">+</span> continent<span class="sc">*</span><span class="fu">factor</span>(year), </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> gapminder))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lifeExp ~ log(gdpPercap) + log(pop) + continent * 
    factor(year), data = gapminder)

Residuals:
     Min       1Q   Median       3Q      Max 
-26.5678  -2.5530   0.0044   2.9146  15.5667 

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         3.04133    2.07409   1.466 0.142746    
log(gdpPercap)                      5.07950    0.16049  31.650  &lt; 2e-16 ***
log(pop)                            0.07894    0.09427   0.837 0.402510    
continentAmericas                   7.69602    1.39324   5.524 3.85e-08 ***
continentAsia                       4.80781    1.26567   3.799 0.000151 ***
continentEurope                    17.05075    1.32948  12.825  &lt; 2e-16 ***
continentOceania                   18.07902    4.08899   4.421 1.05e-05 ***
factor(year)1957                    1.64615    1.10777   1.486 0.137470    
factor(year)1962                    3.12865    1.10838   2.823 0.004819 ** 
factor(year)1967                    4.43915    1.10969   4.000 6.61e-05 ***
factor(year)1972                    5.99560    1.11134   5.395 7.85e-08 ***
factor(year)1977                    7.95776    1.11240   7.154 1.27e-12 ***
factor(year)1982                    9.94918    1.11336   8.936  &lt; 2e-16 ***
factor(year)1987                   11.95748    1.11375  10.736  &lt; 2e-16 ***
factor(year)1992                   12.33976    1.11463  11.071  &lt; 2e-16 ***
factor(year)1997                   12.18479    1.11605  10.918  &lt; 2e-16 ***
factor(year)2002                   11.61877    1.11805  10.392  &lt; 2e-16 ***
factor(year)2007                   12.48567    1.12120  11.136  &lt; 2e-16 ***
continentAmericas:factor(year)1957  0.43301    1.94383   0.223 0.823748    
continentAsia:factor(year)1957      0.51422    1.77764   0.289 0.772410    
continentEurope:factor(year)1957   -0.46380    1.83127  -0.253 0.800095    
continentOceania:factor(year)1957  -1.21261    5.75524  -0.211 0.833150    
continentAmericas:factor(year)1962  1.00431    1.94383   0.517 0.605458    
continentAsia:factor(year)1962      0.64348    1.77767   0.362 0.717414    
continentEurope:factor(year)1962   -1.09110    1.83146  -0.596 0.551422    
continentOceania:factor(year)1962  -2.37738    5.75524  -0.413 0.679601    
continentAmericas:factor(year)1967  1.07497    1.94383   0.553 0.580329    
continentAsia:factor(year)1967      1.73865    1.77767   0.978 0.328194    
continentEurope:factor(year)1967   -2.26082    1.83170  -1.234 0.217278    
continentOceania:factor(year)1967  -4.14682    5.75524  -0.721 0.471302    
continentAmericas:factor(year)1972  0.79724    1.94383   0.410 0.681756    
continentAsia:factor(year)1972      1.73772    1.77790   0.977 0.328513    
continentEurope:factor(year)1972   -3.88011    1.83221  -2.118 0.034348 *  
continentOceania:factor(year)1972  -5.74146    5.75524  -0.998 0.318618    
continentAmericas:factor(year)1977  0.15055    1.94389   0.077 0.938277    
continentAsia:factor(year)1977      1.25493    1.77837   0.706 0.480498    
continentEurope:factor(year)1977   -5.41829    1.83293  -2.956 0.003160 ** 
continentOceania:factor(year)1977  -7.01748    5.75525  -1.219 0.222899    
continentAmericas:factor(year)1982 -0.09483    1.94391  -0.049 0.961100    
continentAsia:factor(year)1982      1.78543    1.77884   1.004 0.315670    
continentEurope:factor(year)1982   -6.97588    1.83363  -3.804 0.000147 ***
continentOceania:factor(year)1982  -7.94094    5.75529  -1.380 0.167847    
continentAmericas:factor(year)1987 -0.22666    1.94400  -0.117 0.907197    
continentAsia:factor(year)1987      1.68580    1.77960   0.947 0.343629    
continentEurope:factor(year)1987   -8.59548    1.83497  -4.684 3.04e-06 ***
continentOceania:factor(year)1987  -9.41040    5.75542  -1.635 0.102230    
continentAmericas:factor(year)1992  0.82125    1.94407   0.422 0.672760    
continentAsia:factor(year)1992      2.61266    1.78035   1.468 0.142431    
continentEurope:factor(year)1992   -7.76308    1.83465  -4.231 2.45e-05 ***
continentOceania:factor(year)1992  -8.25667    5.75549  -1.435 0.151599    
continentAmericas:factor(year)1997  2.10061    1.94427   1.080 0.280118    
continentAsia:factor(year)1997      3.64834    1.78125   2.048 0.040700 *  
continentEurope:factor(year)1997   -7.17732    1.83581  -3.910 9.62e-05 ***
continentOceania:factor(year)1997  -7.56911    5.75567  -1.315 0.188670    
continentAmericas:factor(year)2002  3.83793    1.94418   1.974 0.048542 *  
continentAsia:factor(year)2002      5.03611    1.78142   2.827 0.004755 ** 
continentEurope:factor(year)2002   -6.10046    1.83686  -3.321 0.000916 ***
continentOceania:factor(year)2002  -6.02872    5.75579  -1.047 0.295061    
continentAmericas:factor(year)2007  3.26772    1.94437   1.681 0.093029 .  
continentAsia:factor(year)2007      4.64828    1.78228   2.608 0.009188 ** 
continentEurope:factor(year)2007   -6.92231    1.83777  -3.767 0.000171 ***
continentOceania:factor(year)2007  -6.42217    5.75579  -1.116 0.264682    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.648 on 1642 degrees of freedom
Multiple R-squared:  0.8157,    Adjusted R-squared:  0.8088 
F-statistic: 119.1 on 61 and 1642 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
</section>
<section id="smoothing" class="level1">
<h1>Smoothing</h1>
<p>Linear regression and GLMs are of course useful, but often the relationship is not linear, even on some transformed scale.</p>
<p>Additive models and generalized additive models (GAMs) are the more flexible variants on linear models and GLMs.</p>
<p>There are a variety of tools in R for modeling nonlinear and smooth relationships, mirroring the variety of methods in the literature.</p>
<p>One workhorse is <code>gam()</code> in the <em>mgcv</em> package.</p>
<section id="mgcvgam-in-action" class="level2">
<h2 class="anchored" data-anchor-id="mgcvgam-in-action"><code>mgcv::gam</code> in action</h2>
<p>Do we think there should be a linear relationship of life expectancy with GDP and year?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: nlme</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is mgcv 1.9-1. For overview type 'help("mgcv-package")'.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">gam</span>(lifeExp <span class="sc">~</span> <span class="fu">s</span>(gdpPercap, <span class="at">k =</span> <span class="dv">30</span>) <span class="sc">+</span> <span class="fu">s</span>(year, <span class="at">k =</span> <span class="dv">10</span>), <span class="at">data =</span> gapminder)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/gamExample-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/gamExample-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
lifeExp ~ s(gdpPercap, k = 30) + s(year, k = 10)

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  59.4744     0.1605   370.6   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
                edf Ref.df     F p-value    
s(gdpPercap) 12.619  15.50 226.4  &lt;2e-16 ***
s(year)       3.148   3.91 110.9  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =  0.737   Deviance explained = 73.9%
GCV = 44.315  Scale est. = 43.879    n = 1704</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">gam</span>(lifeExp <span class="sc">~</span> <span class="fu">s</span>(<span class="fu">log</span>(gdpPercap), <span class="at">k =</span> <span class="dv">30</span>) <span class="sc">+</span> <span class="fu">s</span>(year, <span class="at">k =</span> <span class="dv">10</span>), <span class="at">data =</span> gapminder)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/gamExample-3.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/gamExample-4.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Building on that, we could use the same kind of functionality as in lm/glm in terms of factors and interactions.</p>
</section>
<section id="how-does-gam-choose-how-much-to-smooth" class="level2">
<h2 class="anchored" data-anchor-id="how-does-gam-choose-how-much-to-smooth">How does GAM choose how much to smooth?</h2>
<p>GAM uses the data to choose how much smoothing to do. Roughly one can think of what it is doing as carrying out cross-validation and choosing the best amount of smoothing for predicting held-out data, but without having to actually do cross-validation.</p>
<p><code>k</code> simply sets an upper bound on the amount of smoothing (you can think of <code>k</code> as the number of degrees of freedom - “1” would be a linear fit).</p>
<ul>
<li>Make sure <code>k</code> is less than the number of unique values of the predictor variable</li>
<li>The default for <code>k</code> is relatively small and in some cases this may overly limit the smoothness of the curve.
<ul>
<li>You can try increasing <code>k</code> and see if it improves the fit.</li>
<li>If <code>summary</code> reports an <code>edf</code> that is close to <code>k</code> that often suggests that <code>k</code> should be increased.</li>
</ul></li>
</ul>
</section>
</section>
<section id="distributions" class="level1">
<h1>Distributions</h1>
<p>Since R was developed by statisticians, it handles distributions and simulation seamlessly.</p>
<p>All commonly-used distributions have functions in R. Each distribution has a family of functions:</p>
<ul>
<li>d - probability density/mass function (PDF), e.g.&nbsp;<code>dnorm()</code></li>
<li>r - generate a random value, e.g., <code>rnorm()</code></li>
<li>p - cumulative distribution function (CDF), e.g., <code>pnorm()</code></li>
<li>q - quantile function (inverse CDF), e.g., <code>qnorm()</code></li>
</ul>
<p>Some of the distributions include the following (in the form of their random number generator function): <code>rnorm()</code>, <code>runif()</code>, <code>rbinom()</code>, <code>rpois()</code>, <code>rbeta()</code>, <code>rgamma()</code>, <code>rt()</code>, <code>rchisq()</code>.</p>
<section id="distributions-in-action" class="level2">
<h2 class="anchored" data-anchor-id="distributions-in-action">Distributions in action</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">1.96</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9750021</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(.<span class="dv">975</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.959964</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.0282475249 0.1210608210 0.2334744405 0.2668279320 0.2001209490
 [6] 0.1029193452 0.0367569090 0.0090016920 0.0014467005 0.0001377810
[11] 0.0000059049</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.48672e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dt</span>(<span class="dv">5</span>, <span class="at">df =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01224269</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">dnorm</span>(x), <span class="at">type =</span> <span class="st">'l'</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rmultinom</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">3</span>, .<span class="dv">25</span>, .<span class="dv">05</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]    9
[2,]   11
[3,]   24
[4,]   35
[5,]   18
[6,]    3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">1</span>), <span class="at">type =</span> <span class="st">'l'</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">2</span>), <span class="at">col =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sampling-from-a-finite-set" class="level2">
<h2 class="anchored" data-anchor-id="sampling-from-a-finite-set">Sampling from a finite set</h2>
<p>We can draw a sample with or without replacement.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(gapminder), <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  706  321  119 1516   67 1238  650  344  313 1614  120  141  717  620   40
[16]  459 1249 1352  977  259</code></pre>
</div>
</div>
<p>Here’s an example of some code that would be part of coding up a bootstrap. As I mentioned previously, this would be a weird dataset to do formal statistical inference on given it includes most of the countries in the world, though one could think about fitting models for the variation over time, treating short-term fluctuations as random.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># actual mean</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gapminder<span class="sc">$</span>lifeExp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 59.47444</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here's a bootstrap sample:</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>smp <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(gapminder)), <span class="at">replace =</span> <span class="cn">TRUE</span>) </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gapminder<span class="sc">$</span>lifeExp[smp], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60.1616</code></pre>
</div>
</div>
<p>It’s a good idea to use <code>seq_along()</code> and <code>seq_len()</code> and not syntax like <code>1:length(gapminder)</code> in <code>sample()</code> because the outcome of <code>length()</code> might in some cases be unexpected (e.g., if you’re taking subsets of a dataset). Similar reasoning holds when setting up for loops: e.g.,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(gapminder))) {</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># blah</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-random-seed" class="level2">
<h2 class="anchored" data-anchor-id="the-random-seed">The Random Seed</h2>
<p>A few key facts about generating random numbers</p>
<ul>
<li>Random number generation is based on generating uniformly between 0 and 1 and then transforming to the kind of random number of interest: normal, categorical, etc.</li>
<li>Random numbers on a computer are <em>pseudo-random</em>; they are generated deterministically from a very, very, very long sequence that repeats</li>
<li>The <em>seed</em> determines where you are in that sequence</li>
</ul>
<p>To replicate any work involving random numbers, make sure to set the seed first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>vals <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(gapminder), <span class="dv">10</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>vals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1017  679  129  930 1533  471  299  270 1211 1331</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>vals <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(gapminder), <span class="dv">10</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>vals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  597 1301 1518  330 1615   37 1129  729  878  485</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>vals <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(gapminder), <span class="dv">15</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>vals[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1017  679  129  930 1533  471  299  270 1211 1331</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>vals[<span class="dv">11</span><span class="sc">:</span><span class="dv">15</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  597 1301 1518  330 1615</code></pre>
</div>
</div>
</section>
</section>
<section id="optimization" class="level1">
<h1>Optimization</h1>
<p>R provides functionality for optimization - finding maxima or minima of a function.</p>
<p>A workhorse is <code>optim()</code>, which implements a number of optimization algorithms.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fields)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a> banana <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {   <span class="do">## Rosenbrock Banana function</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>         x1 <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>         x2 <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>         <span class="dv">100</span> <span class="sc">*</span> (x2 <span class="sc">-</span> x1 <span class="sc">*</span> x1)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> x1)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>x1s <span class="ot">&lt;-</span> x2s <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(x1s, x2s)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">1</span>, banana)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mai =</span> <span class="fu">c</span>(.<span class="dv">45</span>, .<span class="dv">4</span>, .<span class="dv">1</span>, .<span class="dv">4</span>))</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="fu">image.plot</span>(x1s, x2s, <span class="fu">matrix</span>(fx, <span class="dv">100</span>), <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="fu">image.plot</span>(x1s, x2s, <span class="fu">matrix</span>(<span class="fu">log</span>(fx), <span class="dv">100</span>), <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">optim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">0</span>), banana)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$par
[1] 1.003369 1.006443

$value
[1] 2.079787e-05

$counts
function gradient 
     181       NA 

$convergence
[1] 0

$message
NULL</code></pre>
</div>
</div>
<p>We can see the progression of evaluations of the objective function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>banana <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {   <span class="do">## Rosenbrock Banana function</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">points</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>])</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">Sys.sleep</span>(.<span class="dv">03</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>         x1 <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>         x2 <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>         <span class="dv">100</span> <span class="sc">*</span> (x2 <span class="sc">-</span> x1 <span class="sc">*</span> x1)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> x1)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">mai =</span> <span class="fu">c</span>(.<span class="dv">45</span>, .<span class="dv">4</span>, .<span class="dv">1</span>, .<span class="dv">4</span>))</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="fu">image.plot</span>(x1s, x2s, <span class="fu">matrix</span>(<span class="fu">log</span>(fx), <span class="dv">100</span>), <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="fu">optim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">0</span>), banana)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dates-and-times" class="level1">
<h1>Dates and Times</h1>
<section id="dates" class="level2">
<h2 class="anchored" data-anchor-id="dates">Dates</h2>
<p>R has built-in functionality to handle dates (don’t reinvent the wheel!).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>date1 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"03-01-2011"</span>, <span class="at">format =</span> <span class="st">"%m-%d-%Y"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>date2 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"03/02/11"</span>, <span class="at">format =</span> <span class="st">"%m/%d/%y"</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>date3 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"07-May-11"</span>, <span class="at">format =</span> <span class="st">"%d-%b-%y"</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>date1; date2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2011-03-01"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2011-03-02"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(date1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Date"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">c</span>(date1, date2, date3)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">weekdays</span>(dates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Tuesday"   "Wednesday" "Saturday" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>dates <span class="sc">+</span> <span class="dv">30</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2011-03-31" "2011-04-01" "2011-06-06"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>date3 <span class="sc">-</span> date2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 66 days</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unclass</span>(dates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15034 15035 15101</code></pre>
</div>
</div>
<p>The “origin” date in R is January 1, 1970</p>
</section>
</section>
<section id="time" class="level1">
<h1>Time</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chron)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">chron</span>(<span class="st">"12/25/2004"</span>, <span class="st">"10:37:59"</span>) </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co"># default format of m/d/Y and h:m:s</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">chron</span>(<span class="st">"12/26/2004"</span>, <span class="st">"11:37:59"</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(d1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "chron" "dates" "times"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>d1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] (12/25/04 10:37:59)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="sc">+</span> <span class="dv">33</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] (01/27/05 10:37:59)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="sc">-</span> d1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time in days:
[1] 1.041667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="sc">+</span> d2  <span class="co"># This won't work.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in Ops.dates(d1, d2): chron objects may not be added together</code></pre>
</div>
</div>
<p>There’s lots more packages/functionality for dates/times: see <code>lubridate</code> (from the tidyverse) and <code>?DateTimeClasses</code></p>
</section>
<section id="breakout" class="level1">
<h1>Breakout</h1>
<section id="basics" class="level3">
<h3 class="anchored" data-anchor-id="basics">Basics</h3>
<ol type="1">
<li><p>Generate 100 random Poisson values with a population mean of 5. How close is the mean of those 100 values to the value of 5?</p></li>
<li><p>What is the 95th percentile of a chi-square distribution with 1 degree of freedom?</p></li>
<li><p>What’s the probability of getting a value greater than 5 if you draw from a standard normal distribution? What about a t distribution with 1 degree of freedom?</p></li>
</ol>
</section>
<section id="using-the-ideas" class="level3">
<h3 class="anchored" data-anchor-id="using-the-ideas">Using the ideas</h3>
<ol start="4" type="1">
<li><p>Fit two linear regression models from the gapminder data, where the outcome is <code>lifeExp</code> and the explanatory variables are <code>log(pop)</code>, <code>log(gdpPercap)</code>, and <code>year</code>. In one model, treat <code>year</code> as a numeric variable. In the other, factorize the <code>year</code> variable. How do you interpret each model?</p></li>
<li><p>Consider the code where we used <code>sample()</code>. Initialize a storage vector of 500 zeroes. Set up a bootstrap using a for loop, with 500 bootstrap datasets. Here are the steps within each iteration:</p></li>
</ol>
<ul>
<li>resample with replacement a new dataset of the same size as the actual <code>gapminder</code> dataset</li>
<li>assign the value of the mean of the life expectancy for the bootstrap dataset into the storage vector</li>
<li>repeat</li>
</ul>
<p>Now plot a histogram of the 500 values - this is an estimate of the sampling distribution of the sample mean.</p>
<ol start="6" type="1">
<li>Modify the GAMs of lifeExp on gdpPercap and set <code>k</code> to a variety of values and see how the estimated relationships change. What about the estimated uncertainties?</li>
</ol>
</section>
<section id="advanced" class="level3">
<h3 class="anchored" data-anchor-id="advanced">Advanced</h3>
<ol start="7" type="1">
<li><p>Fit a logistic regression model where the outcome is whether <code>lifeExp</code> is greater than or less than 60 years, exploring the use of different predictors.</p></li>
<li><p>Suppose you wanted to do 10-fold cross-validation for some sort of regression model fit to the <em>gapminder</em> dataset. Write some R code that produces a field in the dataset that indicates which fold each observation is in. Ensure each of the folds has an equal (or as nearly equal as possible if the number of observations is not divisible by 10) number of observations. Hint: consider the <em>times</em> argument to the <code>rep()</code> function. (If you’re not familiar with 10-fold cross-validation, it requires one to divide the dataset into 10 subsets of approximately equal size.)</p></li>
<li><p>Write some code to demonstrate the central limit theorem. Generate many different replicates of samples of size <code>n</code> from a skewed or discrete distribution and show that if <code>n</code> is big enough, the distribution of the means (of each sample of size <code>n</code>) looks approximately normal in a histogram. Do it without any looping (using techniques from earlier modules)! I.e., I want you to show that if you have a large number (say 10,000) of means, each mean being the mean of <code>n</code> values from a distribution, the distribution of the means looks approximately normal if <code>n</code> is sufficiently big.</p></li>
</ol>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/paciorek\.github\.io\/r-voleon-2025");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb85" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Basic Analysis/Useful Packages"</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co">    css: ../assets/styles.css</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-bg: true</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-border-left: "#31BAE9"</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="co">  freeze: auto</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, chunksetup}</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a><span class="in">#| include: false</span></span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a><span class="in"># include any code here you don't want to show up in the document,</span></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a><span class="in"># e.g. package and dataset loading</span></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a><span class="in">rm(list=ls())</span></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a><span class="in">library(fields)</span></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a><span class="in">library(foreign)</span></span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a><span class="in">library(gapminder)</span></span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a><span class="in">gapminder2007 &lt;- gapminder[gapminder$year == 2007, ]</span></span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a><span class="fu"># Inference/Regression</span></span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*glm* fits a generalized linear model with your choice of family/link function (Gaussian, logit, Poisson, etc.)</span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>*lm* is just a standard linear regression (equivalent to glm with family = gaussian(link = "identity"))</span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The basic glm call looks something like this:</span>
<span id="cb85-32"><a href="#cb85-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-33"><a href="#cb85-33" aria-hidden="true" tabindex="-1"></a>  <span class="in">```{r eval=FALSE}</span></span>
<span id="cb85-34"><a href="#cb85-34" aria-hidden="true" tabindex="-1"></a><span class="in">  glm(formula = y ~ x1 + x2 + x3 + ..., family = familyname(link = "linkname"),</span></span>
<span id="cb85-35"><a href="#cb85-35" aria-hidden="true" tabindex="-1"></a><span class="in">              data = )</span></span>
<span id="cb85-36"><a href="#cb85-36" aria-hidden="true" tabindex="-1"></a><span class="in">  ```</span></span>
<span id="cb85-37"><a href="#cb85-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-38"><a href="#cb85-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There are a bunch of families and links to use (help(family) for a full list), but some essentials are:</span>
<span id="cb85-39"><a href="#cb85-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-40"><a href="#cb85-40" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`binomial(link = "logit")`</span></span>
<span id="cb85-41"><a href="#cb85-41" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`gaussian(link = "identity")`</span></span>
<span id="cb85-42"><a href="#cb85-42" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`poisson(link = "log")`</span></span>
<span id="cb85-43"><a href="#cb85-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-44"><a href="#cb85-44" aria-hidden="true" tabindex="-1"></a>  If you're using <span class="in">`lm`</span>, the call looks the same but without the <span class="in">`family`</span> argument. </span>
<span id="cb85-45"><a href="#cb85-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-46"><a href="#cb85-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Example: suppose we want to regress the life expectency on the GDP per capita and the population, as well as the continent and year.  The lm/glm call would be something like this:</span>
<span id="cb85-47"><a href="#cb85-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-48"><a href="#cb85-48" aria-hidden="true" tabindex="-1"></a>  <span class="in">```{r}</span></span>
<span id="cb85-49"><a href="#cb85-49" aria-hidden="true" tabindex="-1"></a><span class="in">  reg &lt;- lm(formula = lifeExp ~ log(gdpPercap) + log(pop) + continent + year, </span></span>
<span id="cb85-50"><a href="#cb85-50" aria-hidden="true" tabindex="-1"></a><span class="in">                  data = gapminder)</span></span>
<span id="cb85-51"><a href="#cb85-51" aria-hidden="true" tabindex="-1"></a><span class="in">  ```</span></span>
<span id="cb85-52"><a href="#cb85-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-53"><a href="#cb85-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-54"><a href="#cb85-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## Regression output</span></span>
<span id="cb85-55"><a href="#cb85-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-56"><a href="#cb85-56" aria-hidden="true" tabindex="-1"></a><span class="fu">### Basic output in an S3 object</span></span>
<span id="cb85-57"><a href="#cb85-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-60"><a href="#cb85-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb85-61"><a href="#cb85-61" aria-hidden="true" tabindex="-1"></a><span class="co"># View components contained in the regression output</span></span>
<span id="cb85-62"><a href="#cb85-62" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(reg)</span>
<span id="cb85-63"><a href="#cb85-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine regression coefficients</span></span>
<span id="cb85-64"><a href="#cb85-64" aria-hidden="true" tabindex="-1"></a>reg<span class="sc">$</span>coefficients</span>
<span id="cb85-65"><a href="#cb85-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine regression degrees of freedom</span></span>
<span id="cb85-66"><a href="#cb85-66" aria-hidden="true" tabindex="-1"></a>reg<span class="sc">$</span>df.residual</span>
<span id="cb85-67"><a href="#cb85-67" aria-hidden="true" tabindex="-1"></a><span class="co"># See the standard (diagnostic) plots for a regression</span></span>
<span id="cb85-68"><a href="#cb85-68" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg)</span>
<span id="cb85-69"><a href="#cb85-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-70"><a href="#cb85-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-71"><a href="#cb85-71" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary method for regression</span></span>
<span id="cb85-74"><a href="#cb85-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb85-75"><a href="#cb85-75" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg)</span>
<span id="cb85-76"><a href="#cb85-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-77"><a href="#cb85-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-78"><a href="#cb85-78" aria-hidden="true" tabindex="-1"></a>One can also extract useful things from the summary object</span>
<span id="cb85-79"><a href="#cb85-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-82"><a href="#cb85-82" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb85-83"><a href="#cb85-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Store summary method results</span></span>
<span id="cb85-84"><a href="#cb85-84" aria-hidden="true" tabindex="-1"></a>summ_reg <span class="ot">&lt;-</span> <span class="fu">summary</span>(reg)</span>
<span id="cb85-85"><a href="#cb85-85" aria-hidden="true" tabindex="-1"></a><span class="co"># View summary method results objects</span></span>
<span id="cb85-86"><a href="#cb85-86" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(summ_reg)</span>
<span id="cb85-87"><a href="#cb85-87" aria-hidden="true" tabindex="-1"></a><span class="co"># View table of coefficients</span></span>
<span id="cb85-88"><a href="#cb85-88" aria-hidden="true" tabindex="-1"></a>summ_reg<span class="sc">$</span>coefficients</span>
<span id="cb85-89"><a href="#cb85-89" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-90"><a href="#cb85-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-91"><a href="#cb85-91" aria-hidden="true" tabindex="-1"></a>Note that, in our results, R has broken up our variables into their different factor levels (as it will do whenever your regressors have factor levels)</span>
<span id="cb85-92"><a href="#cb85-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-93"><a href="#cb85-93" aria-hidden="true" tabindex="-1"></a>If your data aren't factorized, you can tell lm/glm to *factorize* a variable (i.e. create dummy variables on the fly), e.g.:</span>
<span id="cb85-94"><a href="#cb85-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-95"><a href="#cb85-95" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb85-96"><a href="#cb85-96" aria-hidden="true" tabindex="-1"></a><span class="in">glm(formula = y ~ x1 + x2 + factor(x3), family = family(link = "link"),</span></span>
<span id="cb85-97"><a href="#cb85-97" aria-hidden="true" tabindex="-1"></a><span class="in">            data = )</span></span>
<span id="cb85-98"><a href="#cb85-98" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-99"><a href="#cb85-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-100"><a href="#cb85-100" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setting up regression interactions</span></span>
<span id="cb85-101"><a href="#cb85-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-102"><a href="#cb85-102" aria-hidden="true" tabindex="-1"></a>There are also some useful shortcuts for regressing on interaction terms:</span>
<span id="cb85-103"><a href="#cb85-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-104"><a href="#cb85-104" aria-hidden="true" tabindex="-1"></a><span class="in">`x1:x2`</span> interacts all terms in x1 with all terms in x2</span>
<span id="cb85-105"><a href="#cb85-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-108"><a href="#cb85-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb85-109"><a href="#cb85-109" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> <span class="fu">log</span>(gdpPercap) <span class="sc">+</span> <span class="fu">log</span>(pop) <span class="sc">+</span></span>
<span id="cb85-110"><a href="#cb85-110" aria-hidden="true" tabindex="-1"></a>                    continent<span class="sc">:</span><span class="fu">factor</span>(year), </span>
<span id="cb85-111"><a href="#cb85-111" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> gapminder))</span>
<span id="cb85-112"><a href="#cb85-112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-113"><a href="#cb85-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-114"><a href="#cb85-114" aria-hidden="true" tabindex="-1"></a><span class="in">`x1*x2`</span> produces the cross of x1 and x2, or x1+x2+x1:x2</span>
<span id="cb85-115"><a href="#cb85-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-118"><a href="#cb85-118" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb85-119"><a href="#cb85-119" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> <span class="fu">log</span>(gdpPercap) <span class="sc">+</span> <span class="fu">log</span>(pop) <span class="sc">+</span> continent<span class="sc">*</span><span class="fu">factor</span>(year), </span>
<span id="cb85-120"><a href="#cb85-120" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> gapminder))</span>
<span id="cb85-121"><a href="#cb85-121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-122"><a href="#cb85-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-123"><a href="#cb85-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-124"><a href="#cb85-124" aria-hidden="true" tabindex="-1"></a><span class="fu"># Smoothing</span></span>
<span id="cb85-125"><a href="#cb85-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-126"><a href="#cb85-126" aria-hidden="true" tabindex="-1"></a>Linear regression and GLMs are of course useful, but often the relationship is not linear, even on some transformed scale.</span>
<span id="cb85-127"><a href="#cb85-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-128"><a href="#cb85-128" aria-hidden="true" tabindex="-1"></a>Additive models and generalized additive models (GAMs) are the more flexible variants on linear models and GLMs.</span>
<span id="cb85-129"><a href="#cb85-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-130"><a href="#cb85-130" aria-hidden="true" tabindex="-1"></a>There are a variety of tools in R for modeling nonlinear and smooth relationships, mirroring the variety of methods in the literature.</span>
<span id="cb85-131"><a href="#cb85-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-132"><a href="#cb85-132" aria-hidden="true" tabindex="-1"></a>One workhorse is <span class="in">`gam()`</span> in the *mgcv* package.</span>
<span id="cb85-133"><a href="#cb85-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-134"><a href="#cb85-134" aria-hidden="true" tabindex="-1"></a><span class="fu">## `mgcv::gam` in action</span></span>
<span id="cb85-135"><a href="#cb85-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-136"><a href="#cb85-136" aria-hidden="true" tabindex="-1"></a>Do we think there should be a linear relationship of life expectancy with GDP and year?</span>
<span id="cb85-137"><a href="#cb85-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-138"><a href="#cb85-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gamExample, cache=TRUE, fig.width=10, fig.cap = ""}</span></span>
<span id="cb85-139"><a href="#cb85-139" aria-hidden="true" tabindex="-1"></a><span class="in">library(mgcv)</span></span>
<span id="cb85-140"><a href="#cb85-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-141"><a href="#cb85-141" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- gam(lifeExp ~ s(gdpPercap, k = 30) + s(year, k = 10), data = gapminder)</span></span>
<span id="cb85-142"><a href="#cb85-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-143"><a href="#cb85-143" aria-hidden="true" tabindex="-1"></a><span class="in">plot(mod)</span></span>
<span id="cb85-144"><a href="#cb85-144" aria-hidden="true" tabindex="-1"></a><span class="in">summary(mod)</span></span>
<span id="cb85-145"><a href="#cb85-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-146"><a href="#cb85-146" aria-hidden="true" tabindex="-1"></a><span class="in">mod2 &lt;- gam(lifeExp ~ s(log(gdpPercap), k = 30) + s(year, k = 10), data = gapminder)</span></span>
<span id="cb85-147"><a href="#cb85-147" aria-hidden="true" tabindex="-1"></a><span class="in">plot(mod2)</span></span>
<span id="cb85-148"><a href="#cb85-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-149"><a href="#cb85-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-150"><a href="#cb85-150" aria-hidden="true" tabindex="-1"></a>Building on that, we could use the same kind of functionality as in lm/glm in terms of factors and interactions.</span>
<span id="cb85-151"><a href="#cb85-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-152"><a href="#cb85-152" aria-hidden="true" tabindex="-1"></a><span class="fu">## How does GAM choose how much to smooth?</span></span>
<span id="cb85-153"><a href="#cb85-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-154"><a href="#cb85-154" aria-hidden="true" tabindex="-1"></a>GAM uses the data to choose how much smoothing to do. Roughly one can think of what it is doing as carrying out cross-validation and choosing the best amount of smoothing for predicting held-out data, but without having to actually do cross-validation.</span>
<span id="cb85-155"><a href="#cb85-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-156"><a href="#cb85-156" aria-hidden="true" tabindex="-1"></a><span class="in">`k`</span> simply sets an upper bound on the amount of smoothing (you can think of <span class="in">`k`</span> as the number of degrees of freedom - "1" would be a linear fit).</span>
<span id="cb85-157"><a href="#cb85-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-158"><a href="#cb85-158" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>Make sure <span class="in">`k`</span> is less than the number of unique values of the predictor variable</span>
<span id="cb85-159"><a href="#cb85-159" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>The default for <span class="in">`k`</span> is relatively small and in some cases this may overly limit the smoothness of the curve.</span>
<span id="cb85-160"><a href="#cb85-160" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>You can try increasing <span class="in">`k`</span> and see if it improves the fit.</span>
<span id="cb85-161"><a href="#cb85-161" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>If <span class="in">`summary`</span> reports an <span class="in">`edf`</span> that is close to <span class="in">`k`</span> that often suggests that <span class="in">`k`</span> should be increased.</span>
<span id="cb85-162"><a href="#cb85-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-163"><a href="#cb85-163" aria-hidden="true" tabindex="-1"></a><span class="fu"># Distributions</span></span>
<span id="cb85-164"><a href="#cb85-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-165"><a href="#cb85-165" aria-hidden="true" tabindex="-1"></a>Since R was developed by statisticians, it handles distributions and simulation seamlessly.</span>
<span id="cb85-166"><a href="#cb85-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-167"><a href="#cb85-167" aria-hidden="true" tabindex="-1"></a>All commonly-used distributions have functions in R. Each distribution has a family of functions: </span>
<span id="cb85-168"><a href="#cb85-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-169"><a href="#cb85-169" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>d - probability density/mass function (PDF), e.g. <span class="in">`dnorm()`</span></span>
<span id="cb85-170"><a href="#cb85-170" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>r - generate a random value, e.g., <span class="in">`rnorm()`</span></span>
<span id="cb85-171"><a href="#cb85-171" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>p - cumulative distribution function (CDF), e.g., <span class="in">`pnorm()`</span></span>
<span id="cb85-172"><a href="#cb85-172" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>q - quantile function (inverse CDF), e.g., <span class="in">`qnorm()`</span></span>
<span id="cb85-173"><a href="#cb85-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-174"><a href="#cb85-174" aria-hidden="true" tabindex="-1"></a>Some of the distributions include the following (in the form of their random number generator function): <span class="in">`rnorm()`</span>, <span class="in">`runif()`</span>, <span class="in">`rbinom()`</span>, <span class="in">`rpois()`</span>, <span class="in">`rbeta()`</span>, <span class="in">`rgamma()`</span>, <span class="in">`rt()`</span>, <span class="in">`rchisq()`</span>.</span>
<span id="cb85-175"><a href="#cb85-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-176"><a href="#cb85-176" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distributions in action</span></span>
<span id="cb85-177"><a href="#cb85-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-178"><a href="#cb85-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap = ""}</span></span>
<span id="cb85-179"><a href="#cb85-179" aria-hidden="true" tabindex="-1"></a><span class="in">pnorm(1.96)</span></span>
<span id="cb85-180"><a href="#cb85-180" aria-hidden="true" tabindex="-1"></a><span class="in">qnorm(.975)</span></span>
<span id="cb85-181"><a href="#cb85-181" aria-hidden="true" tabindex="-1"></a><span class="in">dbinom(0:10, size = 10, prob = 0.3)</span></span>
<span id="cb85-182"><a href="#cb85-182" aria-hidden="true" tabindex="-1"></a><span class="in">dnorm(5)</span></span>
<span id="cb85-183"><a href="#cb85-183" aria-hidden="true" tabindex="-1"></a><span class="in">dt(5, df = 1)</span></span>
<span id="cb85-184"><a href="#cb85-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-185"><a href="#cb85-185" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(-5, 5, length = 100)</span></span>
<span id="cb85-186"><a href="#cb85-186" aria-hidden="true" tabindex="-1"></a><span class="in">plot(x, dnorm(x), type = 'l')</span></span>
<span id="cb85-187"><a href="#cb85-187" aria-hidden="true" tabindex="-1"></a><span class="in">lines(x, dt(x, df = 1), col = 'red')</span></span>
<span id="cb85-188"><a href="#cb85-188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-189"><a href="#cb85-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-190"><a href="#cb85-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap = ""}</span></span>
<span id="cb85-191"><a href="#cb85-191" aria-hidden="true" tabindex="-1"></a><span class="in">rmultinom(1, 100, prob = c(.1, .1, .2, .3, .25, .05)) </span></span>
<span id="cb85-192"><a href="#cb85-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-193"><a href="#cb85-193" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 10, length = 100)</span></span>
<span id="cb85-194"><a href="#cb85-194" aria-hidden="true" tabindex="-1"></a><span class="in">plot(x, dchisq(x, df = 1), type = 'l')</span></span>
<span id="cb85-195"><a href="#cb85-195" aria-hidden="true" tabindex="-1"></a><span class="in">lines(x, dchisq(x, df = 2), col = 'red')</span></span>
<span id="cb85-196"><a href="#cb85-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-197"><a href="#cb85-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-198"><a href="#cb85-198" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sampling from a finite set </span></span>
<span id="cb85-199"><a href="#cb85-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-200"><a href="#cb85-200" aria-hidden="true" tabindex="-1"></a>We can draw a sample with or without replacement.</span>
<span id="cb85-201"><a href="#cb85-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-204"><a href="#cb85-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb85-205"><a href="#cb85-205" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(gapminder), <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb85-206"><a href="#cb85-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-207"><a href="#cb85-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-208"><a href="#cb85-208" aria-hidden="true" tabindex="-1"></a>Here's an example of some code that would be part of coding up a bootstrap. As I mentioned previously, this would be a weird dataset to do formal statistical inference on given it includes most of the countries in the world, though one could think about fitting models for the variation over time, treating short-term fluctuations as random.</span>
<span id="cb85-209"><a href="#cb85-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-212"><a href="#cb85-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb85-213"><a href="#cb85-213" aria-hidden="true" tabindex="-1"></a><span class="co"># actual mean</span></span>
<span id="cb85-214"><a href="#cb85-214" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gapminder<span class="sc">$</span>lifeExp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-215"><a href="#cb85-215" aria-hidden="true" tabindex="-1"></a><span class="co"># here's a bootstrap sample:</span></span>
<span id="cb85-216"><a href="#cb85-216" aria-hidden="true" tabindex="-1"></a>smp <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(gapminder)), <span class="at">replace =</span> <span class="cn">TRUE</span>) </span>
<span id="cb85-217"><a href="#cb85-217" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gapminder<span class="sc">$</span>lifeExp[smp], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-218"><a href="#cb85-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-219"><a href="#cb85-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-220"><a href="#cb85-220" aria-hidden="true" tabindex="-1"></a>It's a good idea to use <span class="in">`seq_along()`</span> and <span class="in">`seq_len()`</span> and not syntax like <span class="in">`1:length(gapminder)`</span> in <span class="in">`sample()`</span> because the outcome of <span class="in">`length()`</span> might in some cases be unexpected (e.g., if you're taking subsets of a dataset). Similar reasoning holds when setting up for loops: e.g., </span>
<span id="cb85-221"><a href="#cb85-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-222"><a href="#cb85-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb85-223"><a href="#cb85-223" aria-hidden="true" tabindex="-1"></a><span class="in">for(i in seq_len(nrow(gapminder))) {</span></span>
<span id="cb85-224"><a href="#cb85-224" aria-hidden="true" tabindex="-1"></a><span class="in"># blah</span></span>
<span id="cb85-225"><a href="#cb85-225" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb85-226"><a href="#cb85-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-227"><a href="#cb85-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-228"><a href="#cb85-228" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Random Seed</span></span>
<span id="cb85-229"><a href="#cb85-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-230"><a href="#cb85-230" aria-hidden="true" tabindex="-1"></a>A few key facts about generating random numbers</span>
<span id="cb85-231"><a href="#cb85-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-232"><a href="#cb85-232" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Random number generation is based on generating uniformly between 0 and 1 and then transforming to the kind of random number of interest: normal, categorical, etc.</span>
<span id="cb85-233"><a href="#cb85-233" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Random numbers on a computer are *pseudo-random*; they are generated deterministically from a very, very, very long sequence that repeats</span>
<span id="cb85-234"><a href="#cb85-234" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The *seed* determines where you are in that sequence</span>
<span id="cb85-235"><a href="#cb85-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-236"><a href="#cb85-236" aria-hidden="true" tabindex="-1"></a>To replicate any work involving random numbers, make sure to set the seed first.</span>
<span id="cb85-237"><a href="#cb85-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-240"><a href="#cb85-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb85-241"><a href="#cb85-241" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb85-242"><a href="#cb85-242" aria-hidden="true" tabindex="-1"></a>vals <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(gapminder), <span class="dv">10</span>)</span>
<span id="cb85-243"><a href="#cb85-243" aria-hidden="true" tabindex="-1"></a>vals</span>
<span id="cb85-244"><a href="#cb85-244" aria-hidden="true" tabindex="-1"></a>vals <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(gapminder), <span class="dv">10</span>)</span>
<span id="cb85-245"><a href="#cb85-245" aria-hidden="true" tabindex="-1"></a>vals</span>
<span id="cb85-246"><a href="#cb85-246" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb85-247"><a href="#cb85-247" aria-hidden="true" tabindex="-1"></a>vals <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(gapminder), <span class="dv">15</span>)</span>
<span id="cb85-248"><a href="#cb85-248" aria-hidden="true" tabindex="-1"></a>vals[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb85-249"><a href="#cb85-249" aria-hidden="true" tabindex="-1"></a>vals[<span class="dv">11</span><span class="sc">:</span><span class="dv">15</span>]</span>
<span id="cb85-250"><a href="#cb85-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-251"><a href="#cb85-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-252"><a href="#cb85-252" aria-hidden="true" tabindex="-1"></a><span class="fu"># Optimization</span></span>
<span id="cb85-253"><a href="#cb85-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-254"><a href="#cb85-254" aria-hidden="true" tabindex="-1"></a>R provides functionality for optimization - finding maxima or minima of a function. </span>
<span id="cb85-255"><a href="#cb85-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-256"><a href="#cb85-256" aria-hidden="true" tabindex="-1"></a>A workhorse is <span class="in">`optim()`</span>, which implements a number of optimization algorithms. </span>
<span id="cb85-257"><a href="#cb85-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-258"><a href="#cb85-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE, fig.cap = ""} </span></span>
<span id="cb85-259"><a href="#cb85-259" aria-hidden="true" tabindex="-1"></a><span class="in">library(fields)  </span></span>
<span id="cb85-260"><a href="#cb85-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-261"><a href="#cb85-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-262"><a href="#cb85-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=11, fig.height=5, fig.cap = ""}</span></span>
<span id="cb85-263"><a href="#cb85-263" aria-hidden="true" tabindex="-1"></a><span class="in"> banana &lt;- function(x) {   ## Rosenbrock Banana function</span></span>
<span id="cb85-264"><a href="#cb85-264" aria-hidden="true" tabindex="-1"></a><span class="in">         x1 &lt;- x[1]</span></span>
<span id="cb85-265"><a href="#cb85-265" aria-hidden="true" tabindex="-1"></a><span class="in">         x2 &lt;- x[2]</span></span>
<span id="cb85-266"><a href="#cb85-266" aria-hidden="true" tabindex="-1"></a><span class="in">         100 * (x2 - x1 * x1)^2 + (1 - x1)^2</span></span>
<span id="cb85-267"><a href="#cb85-267" aria-hidden="true" tabindex="-1"></a><span class="in">     }</span></span>
<span id="cb85-268"><a href="#cb85-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-269"><a href="#cb85-269" aria-hidden="true" tabindex="-1"></a><span class="in">x1s &lt;- x2s &lt;- seq(-5, 5, length = 100)</span></span>
<span id="cb85-270"><a href="#cb85-270" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- expand.grid(x1s, x2s)</span></span>
<span id="cb85-271"><a href="#cb85-271" aria-hidden="true" tabindex="-1"></a><span class="in">fx &lt;- apply(x, 1, banana)</span></span>
<span id="cb85-272"><a href="#cb85-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-273"><a href="#cb85-273" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(1, 2), mai = c(.45, .4, .1, .4))</span></span>
<span id="cb85-274"><a href="#cb85-274" aria-hidden="true" tabindex="-1"></a><span class="in">image.plot(x1s, x2s, matrix(fx, 100), xlab = '', ylab = '')</span></span>
<span id="cb85-275"><a href="#cb85-275" aria-hidden="true" tabindex="-1"></a><span class="in">image.plot(x1s, x2s, matrix(log(fx), 100), xlab = '', ylab = '')</span></span>
<span id="cb85-276"><a href="#cb85-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-277"><a href="#cb85-277" aria-hidden="true" tabindex="-1"></a><span class="in">optim(c(-2,0), banana)</span></span>
<span id="cb85-278"><a href="#cb85-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-279"><a href="#cb85-279" aria-hidden="true" tabindex="-1"></a>We can see the progression of evaluations of the objective function:</span>
<span id="cb85-280"><a href="#cb85-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE, fig.cap = ""}</span></span>
<span id="cb85-281"><a href="#cb85-281" aria-hidden="true" tabindex="-1"></a><span class="in">banana &lt;- function(x) {   ## Rosenbrock Banana function</span></span>
<span id="cb85-282"><a href="#cb85-282" aria-hidden="true" tabindex="-1"></a><span class="in">         points(x[1],x[2])</span></span>
<span id="cb85-283"><a href="#cb85-283" aria-hidden="true" tabindex="-1"></a><span class="in">         Sys.sleep(.03)</span></span>
<span id="cb85-284"><a href="#cb85-284" aria-hidden="true" tabindex="-1"></a><span class="in">         x1 &lt;- x[1]</span></span>
<span id="cb85-285"><a href="#cb85-285" aria-hidden="true" tabindex="-1"></a><span class="in">         x2 &lt;- x[2]</span></span>
<span id="cb85-286"><a href="#cb85-286" aria-hidden="true" tabindex="-1"></a><span class="in">         100 * (x2 - x1 * x1)^2 + (1 - x1)^2</span></span>
<span id="cb85-287"><a href="#cb85-287" aria-hidden="true" tabindex="-1"></a><span class="in">     }</span></span>
<span id="cb85-288"><a href="#cb85-288" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(1, 1), mai = c(.45, .4, .1, .4))</span></span>
<span id="cb85-289"><a href="#cb85-289" aria-hidden="true" tabindex="-1"></a><span class="in">image.plot(x1s, x2s, matrix(log(fx), 100), xlab = '', ylab = '')</span></span>
<span id="cb85-290"><a href="#cb85-290" aria-hidden="true" tabindex="-1"></a><span class="in">optim(c(-2,0), banana)</span></span>
<span id="cb85-291"><a href="#cb85-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-292"><a href="#cb85-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-293"><a href="#cb85-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-294"><a href="#cb85-294" aria-hidden="true" tabindex="-1"></a><span class="fu"># Dates and Times</span></span>
<span id="cb85-295"><a href="#cb85-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-296"><a href="#cb85-296" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dates</span></span>
<span id="cb85-297"><a href="#cb85-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-298"><a href="#cb85-298" aria-hidden="true" tabindex="-1"></a>R has built-in functionality to handle dates (don't reinvent the wheel!).</span>
<span id="cb85-299"><a href="#cb85-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-300"><a href="#cb85-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r dates}</span></span>
<span id="cb85-301"><a href="#cb85-301" aria-hidden="true" tabindex="-1"></a><span class="in">date1 &lt;- as.Date("03-01-2011", format = "%m-%d-%Y")</span></span>
<span id="cb85-302"><a href="#cb85-302" aria-hidden="true" tabindex="-1"></a><span class="in">date2 &lt;- as.Date("03/02/11", format = "%m/%d/%y")</span></span>
<span id="cb85-303"><a href="#cb85-303" aria-hidden="true" tabindex="-1"></a><span class="in">date3 &lt;- as.Date("07-May-11", format = "%d-%b-%y")</span></span>
<span id="cb85-304"><a href="#cb85-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-305"><a href="#cb85-305" aria-hidden="true" tabindex="-1"></a><span class="in">date1; date2</span></span>
<span id="cb85-306"><a href="#cb85-306" aria-hidden="true" tabindex="-1"></a><span class="in">class(date1)</span></span>
<span id="cb85-307"><a href="#cb85-307" aria-hidden="true" tabindex="-1"></a><span class="in">dates &lt;- c(date1, date2, date3)</span></span>
<span id="cb85-308"><a href="#cb85-308" aria-hidden="true" tabindex="-1"></a><span class="in">weekdays(dates)</span></span>
<span id="cb85-309"><a href="#cb85-309" aria-hidden="true" tabindex="-1"></a><span class="in">dates + 30</span></span>
<span id="cb85-310"><a href="#cb85-310" aria-hidden="true" tabindex="-1"></a><span class="in">date3 - date2</span></span>
<span id="cb85-311"><a href="#cb85-311" aria-hidden="true" tabindex="-1"></a><span class="in">unclass(dates)</span></span>
<span id="cb85-312"><a href="#cb85-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-313"><a href="#cb85-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-314"><a href="#cb85-314" aria-hidden="true" tabindex="-1"></a>The "origin" date in R is January 1, 1970</span>
<span id="cb85-315"><a href="#cb85-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-316"><a href="#cb85-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-317"><a href="#cb85-317" aria-hidden="true" tabindex="-1"></a><span class="fu"># Time</span></span>
<span id="cb85-318"><a href="#cb85-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-319"><a href="#cb85-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb85-320"><a href="#cb85-320" aria-hidden="true" tabindex="-1"></a><span class="in">library(chron)</span></span>
<span id="cb85-321"><a href="#cb85-321" aria-hidden="true" tabindex="-1"></a><span class="in">d1 &lt;- chron("12/25/2004", "10:37:59") </span></span>
<span id="cb85-322"><a href="#cb85-322" aria-hidden="true" tabindex="-1"></a><span class="in"># default format of m/d/Y and h:m:s</span></span>
<span id="cb85-323"><a href="#cb85-323" aria-hidden="true" tabindex="-1"></a><span class="in">d2 &lt;- chron("12/26/2004", "11:37:59")</span></span>
<span id="cb85-324"><a href="#cb85-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-325"><a href="#cb85-325" aria-hidden="true" tabindex="-1"></a><span class="in">class(d1)</span></span>
<span id="cb85-326"><a href="#cb85-326" aria-hidden="true" tabindex="-1"></a><span class="in">d1</span></span>
<span id="cb85-327"><a href="#cb85-327" aria-hidden="true" tabindex="-1"></a><span class="in">d1 + 33</span></span>
<span id="cb85-328"><a href="#cb85-328" aria-hidden="true" tabindex="-1"></a><span class="in">d2 - d1</span></span>
<span id="cb85-329"><a href="#cb85-329" aria-hidden="true" tabindex="-1"></a><span class="in">d1 + d2  # This won't work.</span></span>
<span id="cb85-330"><a href="#cb85-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-331"><a href="#cb85-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-332"><a href="#cb85-332" aria-hidden="true" tabindex="-1"></a>There's lots more packages/functionality for dates/times: see <span class="in">`lubridate`</span> (from the tidyverse) and <span class="in">`?DateTimeClasses`</span></span>
<span id="cb85-333"><a href="#cb85-333" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb85-334"><a href="#cb85-334" aria-hidden="true" tabindex="-1"></a><span class="fu"># Breakout </span></span>
<span id="cb85-335"><a href="#cb85-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-336"><a href="#cb85-336" aria-hidden="true" tabindex="-1"></a><span class="fu">### Basics</span></span>
<span id="cb85-337"><a href="#cb85-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-338"><a href="#cb85-338" aria-hidden="true" tabindex="-1"></a>1) Generate 100 random Poisson values with a population mean of 5. How close is the mean of those 100 values to the value of 5?</span>
<span id="cb85-339"><a href="#cb85-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-340"><a href="#cb85-340" aria-hidden="true" tabindex="-1"></a>2) What is the 95th percentile of a chi-square distribution with 1 degree of freedom?</span>
<span id="cb85-341"><a href="#cb85-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-342"><a href="#cb85-342" aria-hidden="true" tabindex="-1"></a>3) What's the probability of getting a value greater than 5 if you draw from a standard normal distribution? What about a t distribution with 1 degree of freedom?</span>
<span id="cb85-343"><a href="#cb85-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-344"><a href="#cb85-344" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using the ideas</span></span>
<span id="cb85-345"><a href="#cb85-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-346"><a href="#cb85-346" aria-hidden="true" tabindex="-1"></a>4) Fit two linear regression models from the gapminder data, where the outcome is <span class="in">`lifeExp`</span> and the explanatory variables are <span class="in">`log(pop)`</span>, <span class="in">`log(gdpPercap)`</span>, and <span class="in">`year`</span>. In one model, treat <span class="in">`year`</span> as a numeric variable. In the other, factorize the <span class="in">`year`</span> variable. How do you interpret each model?</span>
<span id="cb85-347"><a href="#cb85-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-348"><a href="#cb85-348" aria-hidden="true" tabindex="-1"></a>5) Consider the code where we used <span class="in">`sample()`</span>.  Initialize a storage vector of 500 zeroes. Set up a bootstrap using a for loop, with 500 bootstrap datasets. Here are the steps within each iteration:</span>
<span id="cb85-349"><a href="#cb85-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-350"><a href="#cb85-350" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>resample with replacement a new dataset of the same size as the actual <span class="in">`gapminder`</span> dataset</span>
<span id="cb85-351"><a href="#cb85-351" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>assign the value of the mean of the life expectancy for the bootstrap dataset into the storage vector</span>
<span id="cb85-352"><a href="#cb85-352" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>repeat</span>
<span id="cb85-353"><a href="#cb85-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-354"><a href="#cb85-354" aria-hidden="true" tabindex="-1"></a>Now plot a histogram of the 500 values - this is an estimate of the sampling distribution of the sample mean. </span>
<span id="cb85-355"><a href="#cb85-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-356"><a href="#cb85-356" aria-hidden="true" tabindex="-1"></a>6) Modify the GAMs of lifeExp on gdpPercap and set <span class="in">`k`</span> to a variety of values and see how the estimated relationships change. What about the estimated uncertainties?</span>
<span id="cb85-357"><a href="#cb85-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-358"><a href="#cb85-358" aria-hidden="true" tabindex="-1"></a><span class="fu">### Advanced </span></span>
<span id="cb85-359"><a href="#cb85-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-360"><a href="#cb85-360" aria-hidden="true" tabindex="-1"></a>7) Fit a logistic regression model where the outcome is whether <span class="in">`lifeExp`</span> is greater than or less than 60 years, exploring the use of different predictors.</span>
<span id="cb85-361"><a href="#cb85-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-362"><a href="#cb85-362" aria-hidden="true" tabindex="-1"></a>8) Suppose you wanted to do 10-fold cross-validation for some sort of regression model fit to the *gapminder* dataset. Write some R code that produces a field in the dataset that indicates which fold each observation is in. Ensure each of the folds has an equal (or as nearly equal as possible if the number of observations is not divisible by 10) number of observations. Hint: consider the *times* argument to the <span class="in">`rep()`</span> function. (If you're not familiar with 10-fold cross-validation, it requires one to divide the dataset into 10 subsets of approximately equal size.)</span>
<span id="cb85-363"><a href="#cb85-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-364"><a href="#cb85-364" aria-hidden="true" tabindex="-1"></a>9) Write some code to demonstrate the central limit theorem. Generate many different replicates of samples of size <span class="in">`n`</span> from a skewed or discrete distribution and show that if <span class="in">`n`</span> is big enough, the distribution of the means (of each sample of size <span class="in">`n`</span>) looks approximately normal in a histogram. Do it without any looping (using techniques from earlier modules)! I.e., I want you to show that if you have a large number (say 10,000) of means, each mean being the mean of <span class="in">`n`</span> values from a distribution, the distribution of the means looks approximately normal if <span class="in">`n`</span> is sufficiently big.</span>
<span id="cb85-365"><a href="#cb85-365" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>